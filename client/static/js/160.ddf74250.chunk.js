"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[160],{8160:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var r=n(9060),a=n(7256),i=n(272),l=n(3692),o=n(8960),c=n(9e3),s=n(8320),u=n(6880),d=n(5548),f=n(1552),v=n(3288),h=n(9872),p=n(9572),g=n(9704),m=n(4194),x=n(2148),y=n(5084),j=n(9732),b=n(8964),C=n(4296),w=n(2496);function A(){const e=(0,v.c)(),t=(0,m.KX)(),n=(0,m.Ab)(),[A,D]=(0,r.useState)(!1),[I,O]=(0,r.useState)({username:"",password:""}),{username:k,password:S}=I,[R,V]=(0,r.useState)(""),[N,M]=(0,r.useState)(null),[F,T]=(0,r.useState)(!1),[q,E]=(0,r.useState)(),[P,{error:W}]=(0,j.U)(b.qy),[B,{error:J}]=(0,j.U)(b.GM),[Q,{error:U}]=(0,j.U)(b.Mz),z=e=>{O({...I,[e.target.name]:e.target.value})};return(0,w.jsxs)(a.c,{sx:{...(0,x.mo)({color:(0,h.W4)(e.palette.background.default,.5),imgUrl:"/assets/background/overlay_5.jpg"}),height:1},children:[(0,w.jsx)(y.Ml,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),(0,w.jsx)(o.c,{alignItems:"center",justifyContent:"center",sx:{height:1},children:(0,w.jsxs)(l.c,{sx:{p:5,width:1,maxWidth:420},children:[(0,w.jsx)(u.c,{variant:"h4",children:F?"ACCOUNT VERIFICATION":"SIGN IN"}),F?(0,w.jsxs)("form",{onSubmit:e=>{e.preventDefault(),Q({variables:{code:R,contact:k}}).then((e=>{let{data:r}=e;if(N&&r&&r.confirmAccountVerify){var a;const e=null===(a=r.confirmAccountVerify.position)||void 0===a?void 0:a.role;n((0,g.Mp)(N)),e?[C.QJ.Superuser,C.QJ.Director].includes(e)?t.push("/dashboard"):t.push("/calendar"):t.push("/login")}})).catch((e=>{E(e.message)}))},children:[(0,w.jsxs)(u.c,{variant:"body2",sx:{my:2},children:["Verification code was sent to ".concat(k,"."),(0,w.jsx)(c.c,{onClick:e=>{null!==N&&void 0!==N&&N.uuid&&B({variables:{uuid:N.uuid,contact:k}}).then((e=>{let{data:t}=e;t&&t.requestAccountVerify&&(T(!0),E(void 0),console.log(t.requestAccountVerify))})).catch((e=>{E(e.message)}))},variant:"text",children:"Resend?"})]}),(0,w.jsx)(o.c,{spacing:2,sx:{mb:2},children:(0,w.jsx)(f.o,{length:6,value:R,onChange:e=>V(e)})}),(0,w.jsx)(o.c,{direction:"row",alignItems:"center",justifyContent:"center",sx:{my:2},children:(q||(null===J||void 0===J?void 0:J.message)||(null===U||void 0===U?void 0:U.message))&&(0,w.jsx)(u.c,{variant:"body2",align:"center",color:"error",children:q||(null===J||void 0===J?void 0:J.message)||(null===U||void 0===U?void 0:U.message)})}),(0,w.jsx)(c.c,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:"Verify Account"})]}):(0,w.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=await P({variables:{username:k,password:S}});if(r.data&&r.data.loginOfficer){var a,i,l;const e={uuid:r.data.loginOfficer.uuid,firstName:r.data.loginOfficer.firstName,lastName:r.data.loginOfficer.lastName,role:null===(a=r.data.loginOfficer.position)||void 0===a?void 0:a.role,office:null===(i=r.data.loginOfficer.office)||void 0===i?void 0:i.id,position:null===(l=r.data.loginOfficer.position)||void 0===l?void 0:l.label,avatar:r.data.loginOfficer.avatar};if(M(e),r.data.loginOfficer.verified){var o;n((0,g.Mp)(e));const a=(null===(o=r.data.loginOfficer.position)||void 0===o?void 0:o.role)||C.QJ.Officer;[C.QJ.Superuser,C.QJ.Director].includes(a)?t.push("/dashboard"):t.push("/calendar")}else B({variables:{uuid:r.data.loginOfficer.uuid,contact:k}}).then((e=>{let{data:t}=e;t&&t.requestAccountVerify&&(T(!0),E(void 0),console.log(t.requestAccountVerify))})).catch((e=>{E(e.message)}))}else E("Wrong credentials or account is inactive.")},children:[(0,w.jsxs)(u.c,{variant:"body2",sx:{my:2},children:["Don't have an account?",(0,w.jsx)(i.c,{href:"/register",variant:"subtitle2",sx:{ml:.5,cursor:"pointer"},children:"Sign up"})]}),(0,w.jsxs)(o.c,{spacing:2,sx:{mb:2},children:[(0,w.jsx)(s.c,{name:"username",label:"Email or Phone Number (+63)",value:k,onChange:z,required:!0,fullWidth:!0}),(0,w.jsx)(s.c,{name:"password",label:"Password",type:A?"text":"password",value:S,onChange:z,required:!0,fullWidth:!0,inputProps:{minLength:8},InputProps:{endAdornment:(0,w.jsx)(p.c,{position:"end",children:(0,w.jsx)(d.c,{onClick:()=>D(!A),edge:"end",children:(0,w.jsx)(y.ov,{icon:A?"eva:eye-fill":"eva:eye-off-fill"})})})}})]}),(0,w.jsx)(o.c,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:(0,w.jsx)(i.c,{href:"/password",variant:"subtitle2",underline:"hover",children:"Forgot password?"})}),(0,w.jsx)(o.c,{direction:"row",alignItems:"center",justifyContent:"center",sx:{my:2},children:((null===W||void 0===W?void 0:W.message)||q)&&(0,w.jsx)(u.c,{variant:"body2",align:"center",color:"error",children:(null===W||void 0===W?void 0:W.message)||q})}),(0,w.jsx)(c.c,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:"Sign in"})]})]})})]})}},1552:(e,t,n)=>{n.d(t,{o:()=>b});var r,a=n(6692),i=n(2496),l=n(9060),o=n(2556),c=n(8320),s=n(7256);const u={TextFieldStyled:(0,o.cp)(c.c)(r||(r=(0,a.c)(["\n  input {\n    text-align: center;\n  }\n"])))},d=e=>(0,i.jsx)(u.TextFieldStyled,{...e}),f="ArrowLeft",v="ArrowRight",h="Backspace",p="Home",g="End";function m(e){return e.join("")}function x(e,t){return[...e,t]}function y(e){const t=l.useRef((()=>{throw new Error("Cannot call an event handler while rendering.")}));return l.useInsertionEffect((()=>{t.current=e})),l.useCallback((function(){for(var e,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return null===(e=t.current)||void 0===e?void 0:e.call(t,...r)}),[])}const j=()=>!0,b=l.forwardRef(((e,t)=>{const{value:n="",length:r=4,autoFocus:a=!1,onChange:o,TextFieldsProps:c,onComplete:u,validateChar:b=j,className:C,onBlur:w,...A}=e,D=l.useRef(n),I=y(u),O=y((e=>{const t=e.slice(0,r);return{isCompleted:t.length===r,finalValue:t}}));l.useEffect((()=>{const{isCompleted:e,finalValue:t}=O(D.current);e&&I(t)}),[r,I,O]);const k=function(e,t){return e<=0?[]:Array.from({length:e},t)}(r,((e,t)=>({character:n[t]||"",inputRef:l.createRef()}))),S=e=>k.findIndex((t=>{let{inputRef:n}=t;return n.current===e})),R=()=>k.map((e=>{let{character:t}=e;return t})),V=(e,t)=>{const n=function(e,t,n){return e.map(((e,r)=>t===r?n:e))}(R(),e,t);return m(n)},N=e=>{var t;null===(t=k[e])||void 0===t||null===(t=t.inputRef.current)||void 0===t||t.select()},M=e=>{e+1!==r&&(k[e+1].character?N(e+1):(e=>{var t;null===(t=k[e])||void 0===t||null===(t=t.inputRef.current)||void 0===t||t.focus()})(e+1))},F=(e,t)=>"function"!=typeof b||b(e,t),T=e=>{const t=S(e.target);if(0===t&&e.target.value.length>1){const{finalValue:t,isCompleted:n}=O(e.target.value);return null!==o&&void 0!==o&&o(t),n&&null!==u&&void 0!==u&&u(t),void N(t.length-1)}const n=e.target.value[0]||"";let r=n;r&&!F(r,t)&&(r="");const a=V(t,r);null===o||void 0===o||o(a);const{isCompleted:i,finalValue:l}=O(a);i&&null!==u&&void 0!==u&&u(l),""!==r?a.length-1<t?N(a.length):M(t):""===n&&a.length<=t&&N(t-1)},q=e=>{const t=e.clipboardData.getData("text/plain"),n=e.target,a=k.findIndex((e=>{let{character:t,inputRef:r}=e;return""===t||r.current===n})),i=function(e,t,n){return e.reduce(((e,t,r)=>{const{characters:a,restArrayMerged:i}=e;if(r<n)return{restArrayMerged:i,characters:x(a,t)};const[l,...o]=i;return{restArrayMerged:o,characters:x(a,l||"")}}),{restArrayMerged:t,characters:[]}).characters}(R(),function(e){return e.split("")}(t),a).map(((e,t)=>F(e,t)?e:"")),l=m(i);null===o||void 0===o||o(l);const{isCompleted:c,finalValue:s}=O(l);c?(null!==u&&void 0!==u&&u(s),N(r-1)):N(l.length)};return(0,i.jsx)(s.c,{display:"flex",gap:"20px",alignItems:"center",ref:t,className:"MuiOtpInput-Box ".concat(C||""),...A,children:k.map(((e,t)=>{let{character:r,inputRef:l}=e;const{onPaste:s,onFocus:u,onKeyDown:m,className:x,onBlur:y,...j}="function"==typeof c?c(t)||{}:c||{};return(0,i.jsx)(d,{autoFocus:!!a&&0===t,autoComplete:"one-time-code",value:r,inputRef:l,className:"MuiOtpInput-TextField MuiOtpInput-TextField-".concat(t+1," ").concat(x||""),onPaste:e=>{e.preventDefault(),q(e),null===s||void 0===s||s(e)},onFocus:e=>{e.preventDefault(),e.target.select(),null===u||void 0===u||u(e)},onChange:T,onKeyDown:e=>{(e=>{const t=e.target,n=t.selectionStart,r=t.selectionEnd,a=S(t),i=0===n&&0===r;if(t.value===e.key)e.preventDefault(),M(a);else if(h===e.key)if(t.value){if(i){e.preventDefault();const t=V(a,"");null!==o&&void 0!==o&&o(t),t.length<=a&&N(a-1)}}else e.preventDefault(),N(a-1);else f===e.key?(e.preventDefault(),N(a-1)):v===e.key?(e.preventDefault(),N(a+1)):p===e.key?(e.preventDefault(),N(0)):g===e.key&&(e.preventDefault(),N(k.length-1))})(e),null===m||void 0===m||m(e)},onBlur:e=>{null!==y&&void 0!==y&&y(e),(e=>{if(!k.some((t=>{let{inputRef:n}=t;return n.current===e.relatedTarget}))){const{isCompleted:e,finalValue:t}=O(n);null===w||void 0===w||w(t,e)}})(e)},...j},t)}))})}))}}]);
//# sourceMappingURL=160.ddf74250.chunk.js.map