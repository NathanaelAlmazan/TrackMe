"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[16],{5016:(e,t,n)=>{n.r(t),n.d(t,{default:()=>H});var i=n(2656),r=n(6773),s=n(4488),o=n(3856),c=n(9504),a=n(700),l=n(9904),d=n(7454),p=n(6880),h=n(3692),u=n(1096),x=n(4436),m=n(5656),j=n(5072),f=n(9060),v=n(9736),g=n(1412),y=n(2556),b=n(3456),S=n(99),w=n(3448);function R(e){return(0,w.cp)("MuiCardActions",e)}(0,S.c)("MuiCardActions",["root","spacing"]);var C=n(2496);const I=["disableSpacing","className"],D=(0,y.cp)("div",{name:"MuiCardActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableSpacing&&t.spacing]}})((e=>{let{ownerState:t}=e;return(0,j.c)({display:"flex",alignItems:"center",padding:8},!t.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})})),B=f.forwardRef((function(e,t){const n=(0,b.c)({props:e,name:"MuiCardActions"}),{disableSpacing:i=!1,className:r}=n,s=(0,m.c)(n,I),o=(0,j.c)({},n,{disableSpacing:i}),c=(e=>{const{classes:t,disableSpacing:n}=e,i={root:["root",!n&&"spacing"]};return(0,g.c)(i,R,t)})(o);return(0,C.jsx)(D,(0,j.c)({className:(0,v.c)(c.root,r),ownerState:o,ref:t},s))}));var k=n(7256),W=n(8960),A=n(9e3),E=n(5548),F=n(3358),M=n(5084);function N(e){const t=e.split("_");return t[t.length-1]}function L(e){let{message:t,files:n,onEdit:i,onClose:r}=e;return(0,C.jsxs)(W.c,{spacing:2,children:[(0,C.jsxs)(h.c,{children:[(0,C.jsx)(u.c,{action:(0,C.jsx)(F.c,{title:"Edit Report",children:(0,C.jsx)(E.c,{"aria-label":"settings",onClick:i,children:(0,C.jsx)(M.ov,{icon:"akar-icons:edit"})})})}),(0,C.jsx)(x.c,{children:(0,C.jsx)(p.c,{variant:"body1",children:t})}),n&&n.length>0&&(0,C.jsx)(B,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,C.jsx)(k.c,{sx:{maxWidth:"100%",overflow:"auto",display:"flex",flexDirection:"row"},children:n.map((e=>(0,C.jsx)(p.c,{component:"a",variant:"body2",href:e.trim(),target:"_blank",sx:{mx:"5px"},children:N(e)},e)))})})]}),(0,C.jsx)(W.c,{direction:"row",spacing:2,alignItems:"end",justifyContent:"flex-end",children:(0,C.jsx)(A.c,{color:"inherit",onClick:r,children:"Close"})})]})}var P=n(4380),U=n(9572),_=n(7532),q=n(3608),z=n(3540),O=n(7976);function Q(e){let{content:t,reportId:n,onReport:i,onCancel:r}=e;const[s,o]=(0,f.useState)(t||""),[c,a]=(0,f.useState)([]),[l,d]=(0,f.useState)(),[p,{error:h}]=(0,z.c)(O.aA);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(k.c,{component:"form",onSubmit:async e=>{e.preventDefault();let t=[];if(c.length>0)try{const e=new FormData;c.forEach((t=>{e.append("files",t)}));t=(await q.c.post("https://manage.automos.net/api/upload",e)).data.files}catch(l){return void d("Failed to upload files.")}await p({variables:{id:n,message:s,files:t.map((e=>e.fileUrl))}}),i(),o(""),a([]),r()},children:(0,C.jsxs)(W.c,{spacing:2,children:[(0,C.jsx)(k.c,{sx:{maxWidth:"100%",overflow:"auto",display:"flex",flexDirection:"row"},children:c.map((e=>(0,C.jsx)(_.c,{label:e.name,variant:"outlined",onDelete:()=>{return t=e.name,void a((e=>e.filter((e=>e.name!==t))));var t},sx:{mx:"5px"}},e.name)))}),(0,C.jsx)(P.c,{variant:"outlined",placeholder:"Report...",value:s,onChange:e=>o(e.target.value),multiline:!0,rows:3,required:!0,fullWidth:!0,InputProps:{endAdornment:(0,C.jsx)(U.c,{position:"end",children:(0,C.jsx)(F.c,{title:"Insert File",children:(0,C.jsxs)(E.c,{component:"label",children:[(0,C.jsx)(M.ov,{icon:"material-symbols:attach-file-add-rounded"}),(0,C.jsx)("input",{type:"file",multiple:!0,hidden:!0,style:{display:"none"},onChange:e=>{const t=e.target.files;t&&a((e=>e.concat(function(e){const t=[];for(let n=0;n<e.length;n++){const i=e.item(n);i&&t.push(i)}return t}(t))))}})]})})})}}),(0,C.jsxs)(W.c,{direction:"row",spacing:2,alignItems:"end",justifyContent:"flex-end",children:[(0,C.jsx)(A.c,{color:"inherit",onClick:r,children:"Cancel"}),(0,C.jsx)(A.c,{type:"submit",variant:"contained",color:"inherit",children:"Submit"})]})]})}),(0,C.jsx)(M.wR,{severity:"error",message:(null===h||void 0===h?void 0:h.message)||l})]})}var T=n(4480),G=n(3152);function H(e){let{reportId:t,open:n,onClose:h}=e;const[u,x]=(0,f.useState)(!0),{data:m,error:j,refetch:v}=(0,T.U)(O.uQ,{fetchPolicy:"no-cache",variables:{id:t}});return(0,f.useEffect)((()=>{m&&!m.getSubmittedReportById.message?x(!0):x(!1)}),[m]),(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(i.c,{open:n,onClose:h,maxWidth:"sm",fullWidth:!0,children:[(0,C.jsxs)(r.c,{component:"div",children:[(0,C.jsx)(p.c,{variant:"h4",children:null===m||void 0===m?void 0:m.getSubmittedReportById.report.name}),(0,C.jsx)(p.c,{variant:"body1",children:(0,G.parseType)(null===m||void 0===m?void 0:m.getSubmittedReportById.report.type)})]}),(0,C.jsxs)(s.c,{children:[(0,C.jsx)(l.c,{children:(0,C.jsx)(o.c,{size:"small","aria-label":"dense table",sx:{mb:2},children:(0,C.jsxs)(c.c,{children:[(0,C.jsxs)(d.c,{children:[(0,C.jsx)(a.c,{component:"th",scope:"row",children:(0,C.jsx)(p.c,{variant:"subtitle2",noWrap:!0,children:"Report Basis"})}),(0,C.jsx)(a.c,{children:(0,C.jsx)(p.c,{variant:"body2",children:null===m||void 0===m?void 0:m.getSubmittedReportById.report.basis})})]}),(0,C.jsxs)(d.c,{children:[(0,C.jsx)(a.c,{component:"th",scope:"row",children:(0,C.jsx)(p.c,{variant:"subtitle2",noWrap:!0,children:"Report Office"})}),(0,C.jsx)(a.c,{children:(0,C.jsx)(p.c,{variant:"body2",children:null===m||void 0===m?void 0:m.getSubmittedReportById.office.name})})]}),(0,C.jsxs)(d.c,{children:[(0,C.jsx)(a.c,{component:"th",scope:"row",children:(0,C.jsx)(p.c,{variant:"subtitle2",noWrap:!0,children:"Regional Deadline"})}),(0,C.jsx)(a.c,{children:(0,C.jsx)(p.c,{variant:"body2",children:m&&new Date(m.getSubmittedReportById.localDue).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",weekday:"short"})})})]}),(0,C.jsxs)(d.c,{children:[(0,C.jsx)(a.c,{component:"th",scope:"row",children:(0,C.jsx)(p.c,{variant:"subtitle2",noWrap:!0,children:"National Deadline"})}),(0,C.jsx)(a.c,{children:(0,C.jsx)(p.c,{variant:"body2",children:m&&new Date(m.getSubmittedReportById.nationalDue).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",weekday:"short"})})})]})]})})}),m&&u?(0,C.jsx)(Q,{content:m.getSubmittedReportById.message,reportId:parseInt(m.getSubmittedReportById.id),onReport:()=>v(),onCancel:()=>h()}):(0,C.jsx)(L,{message:null===m||void 0===m?void 0:m.getSubmittedReportById.message,files:null===m||void 0===m?void 0:m.getSubmittedReportById.files,onEdit:()=>x(!u),onClose:()=>h()})]})]}),(0,C.jsx)(M.wR,{severity:"error",message:null===j||void 0===j?void 0:j.message})]})}}}]);
//# sourceMappingURL=16.cde3f2c0.chunk.js.map