"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[848],{5436:(e,n,t)=>{t.d(n,{An:()=>h,CI:()=>g,Cy:()=>y,ED:()=>o,SM:()=>u,SY:()=>m,W6:()=>d,WK:()=>I,Yx:()=>$,aK:()=>j,c3:()=>b,ef:()=>D,f_:()=>s,gp:()=>x,gz:()=>c,kl:()=>p,oV:()=>i,oz:()=>l,sT:()=>v,wb:()=>S,wt:()=>w,yA:()=>f,yu:()=>a});var r=t(4768);const i=(0,r.I)("\n    query GetDocumentTypes {\n        getDocumentTypes {\n            id\n            label\n        }\n    }\n"),s=(0,r.I)("\n    mutation CreateDocumentType($label: String!) {\n        createDocumentType(label: $label) {\n            id\n            label\n        }\n    }\n"),c=(0,r.I)("\n    mutation UpdateDocumentType($id: Int!, $label: String!) {\n        updateDocumentType(id: $id, label: $label) {\n            id\n            label\n        }\n    }\n"),o=(0,r.I)("\n    mutation DeleteDocumentType($id: Int!) {\n        deleteDocumentType(id: $id) {\n            id  \n            label\n        }\n    }\n"),a=(0,r.I)("\n    query GetDocumentPurposes {\n        getDocumentPurposes {\n            id\n            label\n        }\n    }\n"),d=(0,r.I)("\n    mutation CreateDocumentPurpose($label: String!) {\n        createDocumentPurpose(label: $label) {\n            id\n            label\n        }\n    }\n"),l=(0,r.I)("\n    mutation UpdateDocumentPurpose($id: Int!, $label: String!) {\n        updateDocumentPurpose(id: $id, label: $label) {\n            id\n            label\n        }\n    }\n"),u=(0,r.I)("\n    mutation DeleteDocumentPurpose($id: Int!) {\n        deleteDocumentPurpose(id: $id) {\n            id\n            label\n        }\n    }\n"),m=(0,r.I)("\n    query GetDocumentStatus {\n        getDocumentStatus {\n            id\n            label\n            category\n        }\n    }\n"),g=(0,r.I)("\n    mutation CreateDocumentStatus($label: String!, $category: Status!) {\n        createDocumentStatus(label: $label, category: $category) {\n            id\n            label\n            category\n        }\n    }\n"),f=(0,r.I)("\n    mutation UpdateDocumentStatus($id: Int!, $label: String!, $category: Status!) {\n        updateDocumentStatus(id: $id, label: $label, category: $category) {\n            id\n            label\n            category\n        }\n    }\n"),h=(0,r.I)("\n    mutation DeleteDocumentStatus($id: Int!) {\n        deleteDocumentStatus(id: $id) {\n            id\n            label\n            category\n        }\n    }\n"),p=(0,r.I)("\n    query TempReferenceNum {\n        getTempReferenceNum\n    }\n"),x=(0,r.I)("\n    query GetDocumentSummary {\n        getDocumentSummary {\n            closed\n            noaction\n            office\n            ongoing\n            referred\n        }\n    }\n"),j=(0,r.I)("\n    query GetDocuments($officeId: Int) {\n        getDocuments(officeId: $officeId) {\n            referenceNum\n            subject\n            receivedFrom\n            refferedTo {\n                name\n            }\n            tag\n            status {\n                label\n                category\n            }\n            dateCreated\n        }\n    }\n"),I=(0,r.I)("\n    query GetDocumentById($referenceNum: String!) {\n        getDocumentById(referenceNum: $referenceNum) {\n            referenceNum\n            subject\n            description\n            receivedFrom\n            refferedTo {\n                id\n                name\n            }\n            type {\n                id\n                label\n            }\n            purpose {\n                id\n                label\n            }\n            tag\n            status {\n                id\n                label\n                category\n            }\n            dateCreated\n            dateDue\n            comments {\n                id\n                sender {\n                    uuid\n                    avatar\n                    firstName\n                    lastName\n                    position {\n                        label\n                    }\n                }   \n                files\n                message\n                dateCreated\n            }\n        }\n    }\n"),$=(0,r.I)("\n    mutation CreateDocument($subject: String!, $description: String!, $receivedFrom: String!, $typeId: Int!, $purposeId: Int!, $statusId: Int!, $dateDue: String!, $refferedTo: [Int!]!, $tag: Tags) {\n        createDocument(subject: $subject, description: $description, receivedFrom: $receivedFrom, typeId: $typeId, purposeId: $purposeId, statusId: $statusId, dateDue: $dateDue, refferedTo: $refferedTo, tag: $tag) {\n            referenceNum\n        }\n    }\n"),b=(0,r.I)("\n    mutation UpdateDocument($referenceNum: String!, $subject: String, $description: String, $receivedFrom: String, $typeId: Int, $purposeId: Int, $statusId: Int, $tag: Tags, $dateDue: String, $refferedTo: [Int]) {\n        updateDocument(referenceNum: $referenceNum, subject: $subject, description: $description, receivedFrom: $receivedFrom, typeId: $typeId, purposeId: $purposeId, statusId: $statusId, tag: $tag, dateDue: $dateDue, refferedTo: $refferedTo) {\n            referenceNum\n        }\n    }\n"),v=(0,r.I)("\n    mutation DeleteDocument($referenceNum: String!) {\n        deleteDocument(referenceNum: $referenceNum) {\n            subject\n        }\n    }\n"),S=(0,r.I)("\n    mutation DocumentUpdateStatus($referenceNum: String!, $statusId: Int!) {\n        documentUpdateStatus(referenceNum: $referenceNum, statusId: $statusId) {\n            id\n            label\n        }\n    }\n"),D=(0,r.I)("\n    mutation CreateComment($documentId: String!, $senderId: String!, $message: String!, $files: [String!]) {\n        createComment(documentId: $documentId, senderId: $senderId, message: $message, files: $files) {\n            id\n        }\n    }\n"),y=(0,r.I)("\n    subscription DocumentEvents($referenceNum: String!) {\n        documentEvents(referenceNum: $referenceNum) {\n            eventDate\n            eventName\n        }\n    }\n"),w=(0,r.I)("\n    query GetDocumentStatistics($officeId: Int) {\n        getDocumentStatistics(officeId: $officeId) {\n            closed\n            noaction\n            ongoing\n            referred\n        }\n    }\n")},8848:(e,n,t)=>{t.r(n),t.d(n,{default:()=>B});var r=t(9060),i=t(5448),s=t(8960),c=t(9e3),o=t(6880),a=t(1712),d=t(3692),l=t(7256),u=t(3856),m=t(9504),g=t(700),f=t(7454),h=t(9904),p=t(9592),x=t(3358),j=t(6768),I=t(5548),$=t(5594),b=t(9572),v=t(2044),S=t(2496);function D(e){let{filterName:n,onRefresh:t,onFilterName:r}=e;return(0,S.jsxs)(j.c,{sx:{height:96,display:"flex",justifyContent:"space-between",p:e=>e.spacing(0,1,0,3)},children:[(0,S.jsx)($.c,{value:n,onChange:r,placeholder:"Search...",startAdornment:(0,S.jsx)(b.c,{position:"start",children:(0,S.jsx)(v.ov,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),(0,S.jsx)(x.c,{title:"Refresh",children:(0,S.jsx)(I.c,{onClick:t,children:(0,S.jsx)(v.ov,{icon:"mdi:refresh"})})})]})}var y=t(8612),w=t(3248);function N(e){let{order:n,orderBy:t,headLabel:r,onRequestSort:i}=e;return(0,S.jsx)(y.c,{children:(0,S.jsxs)(f.c,{children:[(0,S.jsx)(g.c,{padding:"checkbox",children:(0,S.jsx)(o.c,{variant:"subtitle2",align:"right",noWrap:!0,children:"#"})}),r.map((e=>{return(0,S.jsx)(g.c,{align:e.align||"left",sortDirection:t===e.id&&n,sx:{width:e.width,minWidth:e.minWidth},children:(0,S.jsxs)(w.c,{hideSortIcon:!0,active:t===e.id,direction:t===e.id?n:"asc",onClick:(r=e.id,e=>{i(e,r)}),children:[e.label,t===e.id?(0,S.jsx)(l.c,{sx:{border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"},children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},e.id);var r}))]})})}var C=t(6931),T=t(9344);function F(e){switch(e){case"Ongoing":return"warning";case"Finished":return"success";case"Not Started":return"error";default:return"info"}}function P(e){let{officeId:n,document:t,onView:i,onEdit:s,onDelete:c}=e;const[a,d]=(0,r.useState)(null),[l,u]=(0,r.useState)(!1);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(f.c,{hover:!0,tabIndex:-1,role:"checkbox",children:[(0,S.jsx)(g.c,{padding:"checkbox",children:(0,S.jsx)(o.c,{variant:"subtitle2",align:"right",noWrap:!0,children:"#"})}),(0,S.jsx)(g.c,{component:"th",scope:"row",padding:"none",children:(0,S.jsx)(o.c,{variant:"subtitle2",noWrap:!0,children:t.referenceNum})}),(0,S.jsxs)(g.c,{sx:{minWidth:250},children:[(0,S.jsx)(o.c,{variant:"body2",children:t.subject}),t.tag&&(0,S.jsx)(v.iM,{color:"info",children:t.tag})]}),(0,S.jsx)(g.c,{align:"right",sx:{minWidth:150},children:t.dateCreated}),(0,S.jsx)(g.c,{align:"right",children:t.receivedFrom}),(0,S.jsx)(g.c,{align:"right",sx:{maxWidth:200},children:t.refferedTo}),(0,S.jsx)(g.c,{align:"right",sx:{width:50},children:(0,S.jsx)(v.iM,{color:F(t.status.split("_")[0]),children:t.status.split("_")[1]})}),(0,S.jsx)(g.c,{align:"right",sx:{width:30},children:(0,S.jsx)(I.c,{onClick:e=>{d(e.currentTarget)},children:(0,S.jsx)(v.ov,{icon:"eva:more-vertical-fill"})})})]}),(0,S.jsxs)(C.cp,{open:!!a,anchorEl:a,onClose:()=>{d(null)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[(0,S.jsxs)(T.c,{onClick:e=>{i(e,t.referenceNum),d(null)},children:[(0,S.jsx)(v.ov,{icon:"fluent-mdl2:review-solid",sx:{mr:2}}),"View"]}),void 0===n&&(0,S.jsxs)(T.c,{onClick:e=>{s(e,t.referenceNum),d(null)},children:[(0,S.jsx)(v.ov,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),void 0===n&&(0,S.jsxs)(T.c,{onClick:()=>u(!0),sx:{color:"error.main"},children:[(0,S.jsx)(v.ov,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]}),(0,S.jsx)(v._6,{open:l,onClose:()=>u(!1),onDelete:e=>{c(e,t.referenceNum),d(null),u(!1)}})]})}var k=t(2560),R=t(4480),E=t(8504),W=t(3540),q=t(5436),G=t(8964);function U(e,n,t){return n[t]<e[t]?-1:n[t]>e[t]?1:0}function Q(e){let{officeId:n,onRefresh:t,onView:i,onEdit:s}=e;const{data:c,error:o,refetch:a}=(0,R.U)(q.aK,{variables:{officeId:n}}),{data:x,error:j}=(0,E.Q)(G.G2),[I,$]=(0,r.useState)(0),[b,y]=(0,r.useState)("asc"),[w,C]=(0,r.useState)("referenceNum"),[T,F]=(0,r.useState)(""),[Q,z]=(0,r.useState)(10),[V,A]=(0,r.useState)([]),[O,{error:_}]=(0,W.c)(q.sT);(0,r.useEffect)((()=>{c&&A(c.getDocuments.map((e=>{return{referenceNum:e.referenceNum,subject:e.subject,receivedFrom:e.receivedFrom,refferedTo:(n=e.refferedTo.map((e=>e.name)),n.map((e=>e.split(" ").map((e=>isNaN(parseInt(e))?e.charAt(0).toUpperCase():"-".concat(parseInt(e).toString()))).join(""))).join(", ")),dateCreated:new Date(e.dateCreated).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),status:e.status?"".concat((0,k.SI)(e.status.category),"_").concat((0,k.SI)(e.status.label)):"",tag:e.tag?(0,k.SI)(e.tag):""};var n})))}),[c]),(0,r.useEffect)((()=>{x&&a()}),[x,a]);const B=(0,r.useMemo)((()=>function(e,n){const t=e.map(((e,n)=>[e,n]));return t.sort(((e,t)=>{const r=n(e[0],t[0]);return 0!==r?r:e[1]-t[1]})),t.map((e=>e[0]))}(V.filter((e=>e.referenceNum.includes(T)||e.subject.includes(T)||0===T.length)),function(e,n){return"desc"===e?(e,t)=>U(e,t,n):(e,t)=>-U(e,t,n)}(b,w)).slice(I*Q,I*Q+Q)),[V,T,b,w,I,Q]),M=(e,n)=>i(n),K=(e,n)=>s(n),L=async(e,n)=>{await O({variables:{referenceNum:n}}),await a()};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(d.c,{children:[(0,S.jsx)(D,{filterName:T,onRefresh:async()=>{await a(),t()},onFilterName:e=>{$(0),F(e.target.value)}}),(0,S.jsx)(l.c,{sx:{maxWidth:2400,overflow:"auto"},children:(0,S.jsx)(h.c,{sx:{overflow:"unset"},children:(0,S.jsxs)(u.c,{sx:{minWidth:800},children:[(0,S.jsx)(N,{order:b,orderBy:w,onRequestSort:(e,n)=>{y(w===n&&"asc"===b?"desc":"asc"),C(n)},headLabel:[{id:"referenceNum",label:"Reference"},{id:"subject",label:"Subject",width:250},{id:"dateCreated",label:"Date",align:"right"},{id:"receivedFrom",label:"Received From",align:"right"},{id:"refferedTo",label:"Referred To",align:"right"},{id:"status",label:"Status",align:"right",width:50},{id:"tag",align:"right",width:20}]}),(0,S.jsxs)(m.c,{children:[B.map((e=>(0,S.jsx)(P,{officeId:n,document:e,onView:M,onEdit:K,onDelete:L},e.referenceNum))),0===B.length&&(0,S.jsx)(f.c,{sx:{height:80},children:(0,S.jsx)(g.c,{align:"center",colSpan:6,children:"No results found."})})]})]})})}),(0,S.jsx)(p.c,{page:I,component:"div",count:V.length,rowsPerPage:Q,onPageChange:(e,n)=>{$(n)},rowsPerPageOptions:[10,25,50],onRowsPerPageChange:e=>{$(0),z(parseInt(e.target.value,10))}})]}),(0,S.jsx)(v.wR,{severity:"error",message:(null===o||void 0===o?void 0:o.message)||(null===j||void 0===j?void 0:j.message)||(null===_||void 0===_?void 0:_.message)})]})}var z=t(4296),V=t(4194);const A=(0,r.lazy)((()=>t.e(156).then(t.bind(t,2156)))),O=(0,r.lazy)((()=>Promise.all([t.e(616),t.e(64)]).then(t.bind(t,8064))));function _(e,n){if(n)return e&&[z.QJ.Superuser,z.QJ.Director].includes(e)?void 0:parseInt(n)}function B(){const{office:e,role:n}=(0,V.Cq)((e=>e.auth)),{data:t,error:d,refetch:l}=(0,R.U)(q.wt,{variables:{officeId:_(n,e)}}),{data:u,error:m}=(0,E.Q)(G.G2);(0,r.useEffect)((()=>{u&&l()}),[u,l]);const[g,f]=r.useState(!1),[h,p]=r.useState(!1),[x,j]=r.useState(null),I=()=>{f(!g),j(null)};return(0,S.jsxs)(a.c,{children:[(0,S.jsxs)(s.c,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[(0,S.jsx)(o.c,{variant:"h4",children:"Documents"}),void 0===_(n,e)&&(0,S.jsx)(c.c,{onClick:I,variant:"contained",color:"inherit",startIcon:(0,S.jsx)(v.ov,{icon:"eva:plus-fill"}),children:"Create"})]}),(0,S.jsxs)(i.cp,{container:!0,spacing:2,children:[(0,S.jsx)(i.cp,{item:!0,xs:12,sm:6,md:3,children:(0,S.jsx)(v.aQ,{title:"Referred",total:t?t.getDocumentStatistics.referred:0,color:"success",icon:(0,S.jsx)(v.ov,{icon:"ic:twotone-forward-to-inbox",sx:{width:64,height:64}})})}),(0,S.jsx)(i.cp,{item:!0,xs:12,sm:6,md:3,children:(0,S.jsx)(v.aQ,{title:"Closed",total:t?t.getDocumentStatistics.closed:0,color:"success",icon:(0,S.jsx)(v.ov,{icon:"ep:finished",sx:{width:64,height:64}})})}),(0,S.jsx)(i.cp,{item:!0,xs:12,sm:6,md:3,children:(0,S.jsx)(v.aQ,{title:"Ongoing",total:t?t.getDocumentStatistics.ongoing:0,color:"success",icon:(0,S.jsx)(v.ov,{icon:"fluent-mdl2:processing",sx:{width:64,height:64}})})}),(0,S.jsx)(i.cp,{item:!0,xs:12,sm:6,md:3,children:(0,S.jsx)(v.aQ,{title:"No Action",total:t?t.getDocumentStatistics.noaction:0,color:"success",icon:(0,S.jsx)(v.ov,{icon:"ic:twotone-sticky-note-2",sx:{width:64,height:64}})})}),(0,S.jsx)(i.cp,{item:!0,xs:12,children:(0,S.jsx)(Q,{officeId:_(n,e),onRefresh:()=>l(),onView:e=>{j(e),p(!h)},onEdit:e=>{j(e),f(!0)}})})]}),(0,S.jsx)(r.Suspense,{children:(0,S.jsx)(A,{open:g,referenceNum:x,onClose:I})}),x&&(0,S.jsx)(r.Suspense,{children:(0,S.jsx)(O,{open:h,officeId:_(n,e),referenceNum:x,onClose:()=>{p(!1),j(null)}})}),(0,S.jsx)(v.wR,{severity:"error",message:(null===d||void 0===d?void 0:d.message)||(null===m||void 0===m?void 0:m.message)})]})}}}]);
//# sourceMappingURL=848.fddd88b3.chunk.js.map