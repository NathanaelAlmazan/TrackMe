"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[156],{2156:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var a=n(9060),i=n(2656),r=n(4488),c=n(7667),s=n(9e3),l=n(5448),d=n(8960),o=n(8320),u=n(6880),m=n(3996),h=n(7960),p=n(4480),g=n(9732),v=n(3540),x=n(7868),I=n.n(x),j=n(5084),f=n(8964),y=n(3055),D=n(4296),b=n(2496);const C={subject:"",description:"",receivedFrom:"",typeId:"",purposeId:"",statusId:"",signatureId:"",tag:""};function S(e){let{referenceNum:t,officerId:n,open:x,onClose:S}=e;const{data:w,error:P}=(0,p.U)(f.It,{fetchPolicy:"no-cache"}),{data:W,error:B}=(0,p.U)(y.yu,{fetchPolicy:"no-cache"}),{data:F,error:T}=(0,p.U)(y.SY,{fetchPolicy:"no-cache"}),{data:N,error:U}=(0,p.U)(y.oV,{fetchPolicy:"no-cache"}),{data:O,error:q}=(0,p.U)(f.g9,{fetchPolicy:"no-cache"}),{data:R,error:k,refetch:L}=(0,p.U)(y.kl,{fetchPolicy:"no-cache"}),[Y,{error:A}]=(0,g.U)(y.WK,{fetchPolicy:"no-cache"}),[E,{error:_}]=(0,v.c)(y.Yx),[K,{error:V}]=(0,v.c)(y.c3),[z,G]=(0,a.useState)([]),[H,J]=(0,a.useState)(I()(new Date)),[M,Q]=(0,a.useState)(C),{subject:X,description:Z,receivedFrom:$,typeId:ee,purposeId:te,statusId:ne,signatureId:ae,tag:ie}=M;(0,a.useEffect)((()=>{t?Y({variables:{referenceNum:t,officerId:n}}).then((e=>{let{data:t}=e;t&&(Q({subject:t.getDocumentById.subject,description:t.getDocumentById.description,receivedFrom:t.getDocumentById.receivedFrom,typeId:t.getDocumentById.type?t.getDocumentById.type.id.toString():"",purposeId:t.getDocumentById.purpose?t.getDocumentById.purpose.id.toString():"",tag:t.getDocumentById.tag?t.getDocumentById.tag:"",signatureId:t.getDocumentById.signatory.uuid,statusId:""}),J(I()(new Date(t.getDocumentById.dateDue))),G(t.getDocumentById.referredTo.map((e=>parseInt(e.office.id)))))})):(Q(C),J(I()(new Date)),G([]))}),[t,n,Y]);const re=e=>{Q({...M,[e.target.name]:e.target.value})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.c,{open:x,onClose:S,maxWidth:"lg",fullWidth:!0,children:(0,b.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),t?await K({variables:{referenceNum:t,subject:X,description:Z,receivedFrom:$,typeId:parseInt(ee),purposeId:parseInt(te),signatureId:ae,tag:0===ie.length?null:ie,dateDue:H.toISOString()}}):await E({variables:{subject:X,description:Z,receivedFrom:$,typeId:parseInt(ee),purposeId:parseInt(te),signatureId:ae,tag:0===ie.length?null:ie,referredTo:z.map((e=>({officeId:e,statusId:parseInt(ne)}))),dateDue:H.toISOString()}}),Q(C),J(I()(new Date)),G([]),await L(),S()},children:[(0,b.jsx)(r.c,{children:(0,b.jsxs)(l.cp,{container:!0,spacing:3,children:[(0,b.jsx)(l.cp,{item:!0,xs:12,children:R&&(0,b.jsx)(u.c,{variant:"h6",children:"#".concat(t||R.getTempReferenceNum)})}),(0,b.jsx)(l.cp,{item:!0,xs:12,sm:12,md:8,children:(0,b.jsxs)(l.cp,{container:!0,spacing:3,children:[(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(o.c,{name:"subject",label:"Subject",variant:"outlined",value:X,onChange:re,fullWidth:!0,required:!0})}),(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(o.c,{name:"description",label:"Description",variant:"outlined",value:Z,onChange:re,multiline:!0,rows:4,fullWidth:!0,required:!0})}),(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(o.c,{name:"receivedFrom",label:"Received From",variant:"outlined",value:$,onChange:re,fullWidth:!0,required:!0})}),w&&!t&&(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(j.e,{name:"referredTo",label:"Referred To",selected:z,options:w.getOffices.map((e=>({id:parseInt(e.id),label:e.name}))),onChange:e=>{G(e)}})}),N&&(0,b.jsx)(l.cp,{item:!0,xs:12,sm:6,children:(0,b.jsx)(o.c,{name:"typeId",select:!0,label:"Document Type",value:ee,onChange:re,variant:"outlined",required:!0,fullWidth:!0,children:N.getDocumentTypes.map((e=>(0,b.jsx)(m.c,{value:e.id,children:e.label},e.id)))})}),W&&(0,b.jsx)(l.cp,{item:!0,xs:12,sm:6,children:(0,b.jsx)(o.c,{name:"purposeId",select:!0,label:"Document Purpose",value:te,onChange:re,variant:"outlined",required:!0,fullWidth:!0,children:W.getDocumentPurposes.map((e=>(0,b.jsx)(m.c,{value:e.id,children:e.label},e.id)))})})]})}),(0,b.jsx)(l.cp,{item:!0,xs:12,sm:12,md:4,children:(0,b.jsxs)(d.c,{spacing:3,children:[F&&!t&&(0,b.jsx)(o.c,{name:"statusId",select:!0,label:"Document Status",value:ne,onChange:re,variant:"outlined",required:!0,fullWidth:!0,children:F.getDocumentStatus.filter((e=>e.category===D.sD.Referred||e.category===D.sD.NotActionable||t)).map((e=>(0,b.jsx)(m.c,{value:e.id,children:e.label},e.id)))}),(0,b.jsx)(j.I4,{label:"Deadline",value:H,onChange:e=>{e&&J(e)}}),(0,b.jsxs)(o.c,{name:"tag",select:!0,label:"Document Tag",variant:"outlined",value:ie,onChange:re,fullWidth:!0,children:[(0,b.jsx)(m.c,{value:"",children:"None"}),(0,b.jsx)(m.c,{value:"CONFIDENTIAL",children:"Confidential"}),(0,b.jsx)(m.c,{value:"TOP_PRIORITY",children:"Top Priority"}),(0,b.jsx)(m.c,{value:"FOLLOW_UP",children:"Follow Up"})]}),O&&(0,b.jsx)(o.c,{name:"signatureId",select:!0,label:"Signatory",value:ae,onChange:re,variant:"outlined",required:!0,fullWidth:!0,children:O.getSignatories.map((e=>(0,b.jsx)(m.c,{value:e.uuid,children:(0,b.jsxs)(d.c,{direction:"row",alignItems:"center",spacing:2,children:[(0,b.jsx)(h.c,{alt:e.lastName,src:e.avatar}),(0,b.jsx)(u.c,{variant:"subtitle2",noWrap:!0,children:"".concat(e.firstName," ").concat(e.lastName)})]})},e.uuid)))})]})})]})}),(0,b.jsx)(c.c,{children:(0,b.jsxs)(d.c,{direction:"row",spacing:2,children:[(0,b.jsx)(s.c,{onClick:S,color:"inherit",children:"Cancel"}),(0,b.jsx)(s.c,{variant:"contained",color:"inherit",type:"submit",children:"Save"})]})})]})}),(0,b.jsx)(j.wR,{severity:"error",message:(null===P||void 0===P?void 0:P.message)||(null===B||void 0===B?void 0:B.message)||(null===_||void 0===_?void 0:_.message)||(null===V||void 0===V?void 0:V.message)||(null===T||void 0===T?void 0:T.message)||(null===U||void 0===U?void 0:U.message)||(null===k||void 0===k?void 0:k.message)||(null===A||void 0===A?void 0:A.message)||(null===q||void 0===q?void 0:q.message)})]})}}}]);
//# sourceMappingURL=156.d1774e3a.chunk.js.map