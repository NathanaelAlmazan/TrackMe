"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[156],{2156:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var a=n(9060),i=n(2656),r=n(4488),c=n(7667),s=n(9e3),l=n(5448),d=n(8960),o=n(8320),u=n(6880),m=n(9344),h=n(7960),g=n(4480),p=n(9732),v=n(3540),I=n(7868),x=n.n(I),j=n(4864),f=n(8964),y=n(3055),D=n(4296),b=n(2496);const S={subject:"",description:"",receivedFrom:"",typeId:"",purposeId:"",statusId:"",signatureId:"",tag:""};function C(e){let{referenceNum:t,open:n,onClose:I}=e;const{data:C,error:w}=(0,g.U)(f.It,{fetchPolicy:"no-cache"}),{data:B,error:P}=(0,g.U)(y.yu,{fetchPolicy:"no-cache"}),{data:T,error:W}=(0,g.U)(y.SY,{fetchPolicy:"no-cache"}),{data:F,error:N}=(0,g.U)(y.oV,{fetchPolicy:"no-cache"}),{data:U,error:O}=(0,g.U)(f.g9,{fetchPolicy:"no-cache"}),{data:q,error:k,refetch:R}=(0,g.U)(y.kl,{fetchPolicy:"no-cache"}),[L,{error:Y}]=(0,p.U)(y.WK,{fetchPolicy:"no-cache"}),[A,{error:E}]=(0,v.c)(y.Yx),[_,{error:K}]=(0,v.c)(y.c3),[V,z]=(0,a.useState)([]),[G,H]=(0,a.useState)(x()(new Date)),[J,M]=(0,a.useState)(S),{subject:Q,description:X,receivedFrom:Z,typeId:$,purposeId:ee,statusId:te,signatureId:ne,tag:ae}=J;(0,a.useEffect)((()=>{t?L({variables:{referenceNum:t}}).then((e=>{let{data:t}=e;t&&(M({subject:t.getDocumentById.subject,description:t.getDocumentById.description,receivedFrom:t.getDocumentById.receivedFrom,typeId:t.getDocumentById.type?t.getDocumentById.type.id.toString():"",purposeId:t.getDocumentById.purpose?t.getDocumentById.purpose.id.toString():"",statusId:t.getDocumentById.status?t.getDocumentById.status.id.toString():"",tag:t.getDocumentById.tag?t.getDocumentById.tag:"",signatureId:t.getDocumentById.signatory.uuid}),H(x()(new Date(t.getDocumentById.dateDue))),z(t.getDocumentById.refferedTo.map((e=>parseInt(e.id)))))})):(M(S),H(x()(new Date)),z([]))}),[t,L]);const ie=e=>{M({...J,[e.target.name]:e.target.value})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.c,{open:n,onClose:I,maxWidth:"lg",fullWidth:!0,children:(0,b.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),t?await _({variables:{referenceNum:t,subject:Q,description:X,receivedFrom:Z,typeId:parseInt($),purposeId:parseInt(ee),statusId:parseInt(te),signatureId:ne,tag:0===ae.length?null:ae,refferedTo:V,dateDue:G.toISOString()}}):await A({variables:{subject:Q,description:X,receivedFrom:Z,typeId:parseInt($),purposeId:parseInt(ee),statusId:parseInt(te),signatureId:ne,tag:0===ae.length?null:ae,refferedTo:V,dateDue:G.toISOString()}}),M(S),H(x()(new Date)),z([]),await R(),I()},children:[(0,b.jsx)(r.c,{children:(0,b.jsxs)(l.cp,{container:!0,spacing:3,children:[(0,b.jsx)(l.cp,{item:!0,xs:12,children:q&&(0,b.jsx)(u.c,{variant:"h6",children:"#".concat(t||q.getTempReferenceNum)})}),(0,b.jsx)(l.cp,{item:!0,xs:12,sm:12,md:8,children:(0,b.jsxs)(l.cp,{container:!0,spacing:3,children:[(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(o.c,{name:"subject",label:"Subject",variant:"outlined",value:Q,onChange:ie,fullWidth:!0,required:!0})}),(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(o.c,{name:"description",label:"Description",variant:"outlined",value:X,onChange:ie,multiline:!0,rows:4,fullWidth:!0,required:!0})}),(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(o.c,{name:"receivedFrom",label:"Received From",variant:"outlined",value:Z,onChange:ie,fullWidth:!0,required:!0})}),C&&(0,b.jsx)(l.cp,{item:!0,xs:12,children:(0,b.jsx)(j.e,{name:"referredTo",label:"Referred To",selected:V,options:C.getOffices.map((e=>({id:parseInt(e.id),label:e.name}))),onChange:e=>{z(e)}})}),F&&(0,b.jsx)(l.cp,{item:!0,xs:12,sm:6,children:(0,b.jsx)(o.c,{name:"typeId",select:!0,label:"Document Type",value:$,onChange:ie,variant:"outlined",required:!0,fullWidth:!0,children:F.getDocumentTypes.map((e=>(0,b.jsx)(m.c,{value:e.id,children:e.label},e.id)))})}),B&&(0,b.jsx)(l.cp,{item:!0,xs:12,sm:6,children:(0,b.jsx)(o.c,{name:"purposeId",select:!0,label:"Document Purpose",value:ee,onChange:ie,variant:"outlined",required:!0,fullWidth:!0,children:B.getDocumentPurposes.map((e=>(0,b.jsx)(m.c,{value:e.id,children:e.label},e.id)))})})]})}),(0,b.jsx)(l.cp,{item:!0,xs:12,sm:12,md:4,children:(0,b.jsxs)(d.c,{spacing:3,children:[T&&(0,b.jsx)(o.c,{name:"statusId",select:!0,label:"Document Status",value:te,onChange:ie,variant:"outlined",required:!0,fullWidth:!0,children:T.getDocumentStatus.filter((e=>e.category===D.sD.NotStarted||e.category===D.sD.NotActionable||t)).map((e=>(0,b.jsx)(m.c,{value:e.id,children:e.label},e.id)))}),(0,b.jsx)(j.I4,{label:"Deadline",value:G,onChange:e=>{e&&H(e)}}),(0,b.jsxs)(o.c,{name:"tag",select:!0,label:"Document Tag",variant:"outlined",value:ae,onChange:ie,fullWidth:!0,children:[(0,b.jsx)(m.c,{value:"",children:"None"}),(0,b.jsx)(m.c,{value:"CONFIDENTIAL",children:"Confidential"}),(0,b.jsx)(m.c,{value:"TOP_PRIORITY",children:"Top Prioroty"}),(0,b.jsx)(m.c,{value:"FOLLOW_UP",children:"Follow Up"})]}),U&&(0,b.jsx)(o.c,{name:"signatureId",select:!0,label:"Signatory",value:ne,onChange:ie,variant:"outlined",required:!0,fullWidth:!0,children:U.getSignatories.map((e=>(0,b.jsx)(m.c,{value:e.uuid,children:(0,b.jsxs)(d.c,{direction:"row",alignItems:"center",spacing:2,children:[(0,b.jsx)(h.c,{alt:e.lastName,src:e.avatar}),(0,b.jsx)(u.c,{variant:"subtitle2",noWrap:!0,children:"".concat(e.firstName," ").concat(e.lastName)})]})},e.uuid)))})]})})]})}),(0,b.jsx)(c.c,{children:(0,b.jsxs)(d.c,{direction:"row",spacing:2,children:[(0,b.jsx)(s.c,{onClick:I,color:"inherit",children:"Cancel"}),(0,b.jsx)(s.c,{variant:"contained",color:"inherit",type:"submit",children:"Save"})]})})]})}),(0,b.jsx)(j.wR,{severity:"error",message:(null===w||void 0===w?void 0:w.message)||(null===P||void 0===P?void 0:P.message)||(null===E||void 0===E?void 0:E.message)||(null===K||void 0===K?void 0:K.message)||(null===W||void 0===W?void 0:W.message)||(null===N||void 0===N?void 0:N.message)||(null===k||void 0===k?void 0:k.message)||(null===Y||void 0===Y?void 0:Y.message)||(null===O||void 0===O?void 0:O.message)})]})}}}]);
//# sourceMappingURL=156.005d3ef9.chunk.js.map