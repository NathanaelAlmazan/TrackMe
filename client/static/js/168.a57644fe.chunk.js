"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[168],{7976:(e,n,t)=>{t.d(n,{AX:()=>c,Ax:()=>r,G2:()=>s,UB:()=>l,Wq:()=>d,aA:()=>h,eA:()=>a,uO:()=>o,uQ:()=>u});var i=t(4768);(0,i.I)("\n    query GetReports {\n        getReports {\n            id\n            name\n            basis\n            frequency\n            localDue\n            nationalDue\n        }\n    }\n");const s=(0,i.I)("\n    query GetReportById($id: Int!) {\n        getReportById(id: $id) {\n            id\n            name\n            basis\n            frequency\n            localDue\n            nationalDue  \n        }\n    }\n"),r=(0,i.I)("\n    query GetReportSummary {\n        getReportSummary {\n            office\n            pending\n            submitted\n            total\n        }\n    }\n"),o=(0,i.I)("\n    query GetReportStatistics($officeId: Int) {\n        getReportStatistics(officeId: $officeId) {\n            overdue\n            pending\n            submitted\n            total\n        }\n    }\n"),a=(0,i.I)("\n    mutation CreateReport($name: String!, $basis: String!, $localDue: String!, $nationalDue: String!, $frequency: Frequency!) {\n        createReport(name: $name, basis: $basis, localDue: $localDue, nationalDue: $nationalDue, frequency: $frequency) {\n            id\n        }\n    }\n"),c=(0,i.I)("\n    mutation UpdateReport($id: Int!, $name: String!, $basis: String!, $localDue: String!, $nationalDue: String!, $frequency: Frequency!) {\n        updateReport(id: $id, name: $name, basis: $basis, localDue: $localDue, nationalDue: $nationalDue, frequency: $frequency) {\n            id\n        }\n    }\n"),l=(0,i.I)("\n    mutation DeleteReport($id: Int!) {\n        deleteReport(id: $id) {\n            id\n        }\n    }\n"),d=(0,i.I)("\n    query GetSubmittedReports($officeId: Int) {\n        getSubmittedReports(officeId: $officeId) {\n            id\n            office {\n                id\n                name\n            }\n            report {\n                id\n                name\n                basis\n            }\n            status\n            localDue\n            nationalDue\n        }\n    }\n"),u=(0,i.I)("\n    query GetSubmittedReportById($id: Int!) {\n        getSubmittedReportById(id: $id) {\n            id\n            office {\n                id\n                name\n            }\n            report {\n                id\n                name\n                basis\n            }\n            status\n            localDue\n            nationalDue\n            message\n            files\n        }\n    }\n"),h=(0,i.I)("\n    mutation SubmitReport($id: Int!, $message: String, $files: [String!]) {\n        submitReport(id: $id, message: $message, files: $files) {\n            id\n        }\n    }\n")},5168:(e,n,t)=>{t.r(n),t.d(n,{default:()=>J});var i=t(9060),s=t(5448),r=t(8960),o=t(9e3),a=t(6880),c=t(1712),l=t(2044),d=t(3692),u=t(7256),h=t(3856),f=t(700),x=t(7454),m=t(9504),p=t(9904),g=t(9592),j=t(3358),v=t(6768),b=t(5548),S=t(5594),w=t(9572),I=t(2496);function R(e){let{filterName:n,onRefresh:t,onFilterName:i}=e;return(0,I.jsxs)(v.c,{sx:{height:96,display:"flex",justifyContent:"space-between",p:e=>e.spacing(0,1,0,3)},children:[(0,I.jsx)(S.c,{value:n,onChange:i,placeholder:"Search...",startAdornment:(0,I.jsx)(w.c,{position:"start",children:(0,I.jsx)(l.ov,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),(0,I.jsx)(j.c,{title:"Refresh",children:(0,I.jsx)(b.c,{onClick:t,children:(0,I.jsx)(l.ov,{icon:"mdi:refresh"})})})]})}var D=t(8612),$=t(3248);function y(e){let{order:n,orderBy:t,headLabel:i,onRequestSort:s}=e;return(0,I.jsx)(D.c,{children:(0,I.jsx)(x.c,{children:i.map((e=>{return(0,I.jsx)(f.c,{align:e.align||"left",sortDirection:t===e.id&&n,sx:{width:e.width,minWidth:e.minWidth},children:(0,I.jsxs)($.c,{hideSortIcon:!0,active:t===e.id,direction:t===e.id?n:"asc",onClick:(i=e.id,e=>{s(e,i)}),children:[e.label,t===e.id?(0,I.jsx)(u.c,{sx:{border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"},children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},e.id);var i}))})})}var q=t(6931),C=t(9344);function k(e){switch(e){case"Ongoing":return"warning";case"Finished":return"success";case"Not Started":return"error";default:return"info"}}function P(e){let{officeId:n,report:t,onView:s,onEdit:o,onDelete:c}=e;const[d,u]=(0,i.useState)(null),[h,m]=(0,i.useState)(!1);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(x.c,{hover:!0,tabIndex:-1,role:"checkbox",children:[(0,I.jsx)(f.c,{component:"th",scope:"row",children:(0,I.jsx)(r.c,{direction:"row",alignItems:"center",spacing:2,children:(0,I.jsx)(a.c,{variant:"subtitle2",children:t.name})})}),(0,I.jsx)(f.c,{children:t.office}),(0,I.jsx)(f.c,{children:t.basis}),(0,I.jsx)(f.c,{align:"right",sx:{width:120},children:new Date(t.localDue).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}),(0,I.jsx)(f.c,{align:"right",sx:{width:120},children:new Date(t.nationalDue).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}),(0,I.jsx)(f.c,{align:"right",sx:{width:50},children:(0,I.jsx)(l.iM,{color:k(t.status),children:t.status})}),(0,I.jsx)(f.c,{align:"right",sx:{width:30},children:(0,I.jsx)(b.c,{onClick:e=>{u(e.currentTarget)},children:(0,I.jsx)(l.ov,{icon:"eva:more-vertical-fill"})})})]}),(0,I.jsxs)(q.cp,{open:!!d,anchorEl:d,onClose:()=>{u(null)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:200}},children:[(0,I.jsxs)(C.c,{onClick:e=>{s(e,t.id),u(null)},children:[(0,I.jsx)(l.ov,{icon:"fluent-mdl2:review-solid",sx:{mr:2}}),"View Submission"]}),void 0===n&&(0,I.jsxs)(C.c,{onClick:e=>{o(e,t.reportId),u(null)},children:[(0,I.jsx)(l.ov,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit Report"]}),void 0===n&&(0,I.jsxs)(C.c,{onClick:()=>m(!0),sx:{color:"error.main"},children:[(0,I.jsx)(l.ov,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete Report"]})]}),(0,I.jsx)(l._6,{open:h,onClose:()=>m(!1),onDelete:e=>{c(e,t.reportId),u(null),m(!1)}})]})}var Q=t(4480),B=t(8504),E=t(3540),G=t(7976),N=t(8964),O=t(2560);function F(e,n,t){return n[t]<e[t]?-1:n[t]>e[t]?1:0}function A(e){let{officeId:n,onRefresh:t,onView:s,onEdit:r}=e;const{data:o,error:a,refetch:c}=(0,Q.U)(G.Wq,{variables:{officeId:n}}),{data:j,error:v}=(0,B.Q)(N.G2),[b,S]=(0,i.useState)(0),[w,D]=(0,i.useState)("asc"),[$,q]=(0,i.useState)("id"),[C,k]=(0,i.useState)(""),[A,W]=(0,i.useState)(10),[U,V]=(0,i.useState)([]),[z,{error:L}]=(0,E.c)(G.UB);(0,i.useEffect)((()=>{o&&V(o.getSubmittedReports.map((e=>({id:parseInt(e.id),name:e.report.name,basis:e.report.basis,office:e.office.name,localDue:e.localDue,nationalDue:e.nationalDue,status:(0,O.SI)(e.status),reportId:parseInt(e.report.id)}))))}),[o]),(0,i.useEffect)((()=>{j&&c()}),[j,c]);const J=(0,i.useMemo)((()=>function(e,n){const t=e.map(((e,n)=>[e,n]));return t.sort(((e,t)=>{const i=n(e[0],t[0]);return 0!==i?i:e[1]-t[1]})),t.map((e=>e[0]))}(U.filter((e=>e.name.includes(C)||e.basis.includes(C)||e.office.includes(C)||0===C.length)),function(e,n){return"desc"===e?(e,t)=>F(e,t,n):(e,t)=>-F(e,t,n)}(w,$)).slice(b*A,b*A+A)),[U,C,w,$,b,A]),M=(e,n)=>s(n),T=(e,n)=>r(n),H=async(e,n)=>{await z({variables:{id:n}}),await c()};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(d.c,{children:[(0,I.jsx)(R,{filterName:C,onRefresh:async()=>{await c(),t()},onFilterName:e=>{S(0),k(e.target.value)}}),(0,I.jsx)(u.c,{sx:{maxWidth:2400,overflow:"auto"},children:(0,I.jsx)(p.c,{sx:{overflow:"unset"},children:(0,I.jsxs)(h.c,{sx:{minWidth:800},children:[(0,I.jsx)(y,{order:w,orderBy:$,onRequestSort:(e,n)=>{D($===n&&"asc"===w?"desc":"asc"),q(n)},headLabel:[{id:"name",label:"Report Name",width:250},{id:"office",label:"Report Office"},{id:"basis",label:"Report Basis"},{id:"localDue",label:"Regional Deadline",align:"right"},{id:"nationalDue",label:"National Deadline",align:"right"},{id:"status",label:"Status",align:"right"},{id:"id",align:"right",width:20}]}),(0,I.jsxs)(m.c,{children:[J.map((e=>(0,I.jsx)(P,{report:e,officeId:n,onView:M,onEdit:T,onDelete:H},e.id))),0===J.length&&(0,I.jsx)(x.c,{sx:{height:80},children:(0,I.jsx)(f.c,{align:"center",colSpan:6,children:"No results found."})})]})]})})}),(0,I.jsx)(g.c,{page:b,component:"div",count:U.length,rowsPerPage:A,onPageChange:(e,n)=>{S(n)},rowsPerPageOptions:[10,25,50],onRowsPerPageChange:e=>{S(0),W(parseInt(e.target.value,10))}})]}),(0,I.jsx)(l.wR,{severity:"error",message:(null===a||void 0===a?void 0:a.message)||(null===v||void 0===v?void 0:v.message)||(null===L||void 0===L?void 0:L.message)})]})}var W=t(4296),U=t(4194);const V=(0,i.lazy)((()=>t.e(336).then(t.bind(t,1336)))),z=(0,i.lazy)((()=>Promise.all([t.e(616),t.e(5)]).then(t.bind(t,8005))));function L(e,n){if(n)return e&&[W.QJ.Superuser,W.QJ.Director,W.QJ.HrAdmin].includes(e)?void 0:parseInt(n)}function J(){const{office:e,role:n}=(0,U.Cq)((e=>e.auth)),{data:t,error:d,refetch:u}=(0,Q.U)(G.uO,{variables:{officeId:L(n,e)}}),{data:h,error:f}=(0,B.Q)(N.G2);(0,i.useEffect)((()=>{h&&u()}),[h,u]);const[x,m]=i.useState(!1),[p,g]=i.useState(!1),[j,v]=i.useState(null),b=()=>{m(!x),v(null)};return(0,I.jsxs)(c.c,{children:[(0,I.jsxs)(r.c,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[(0,I.jsx)(a.c,{variant:"h4",children:"Reports"}),void 0===L(n,e)&&(0,I.jsx)(o.c,{onClick:b,variant:"contained",color:"inherit",startIcon:(0,I.jsx)(l.ov,{icon:"eva:plus-fill"}),children:"Create"})]}),(0,I.jsxs)(s.cp,{container:!0,spacing:2,children:[(0,I.jsx)(s.cp,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(l.aQ,{title:"Total Reports",total:t?t.getReportStatistics.total:0,color:"success",icon:(0,I.jsx)(l.ov,{icon:"line-md:document-report-twotone",sx:{width:64,height:64}})})}),(0,I.jsx)(s.cp,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(l.aQ,{title:"Submitted",total:t?t.getReportStatistics.submitted:0,color:"success",icon:(0,I.jsx)(l.ov,{icon:"ep:finished",sx:{width:64,height:64}})})}),(0,I.jsx)(s.cp,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(l.aQ,{title:"Pending",total:t?t.getReportStatistics.pending:0,color:"success",icon:(0,I.jsx)(l.ov,{icon:"fluent-mdl2:processing",sx:{width:64,height:64}})})}),(0,I.jsx)(s.cp,{item:!0,xs:12,sm:6,md:3,children:(0,I.jsx)(l.aQ,{title:"Overdue",total:t?t.getReportStatistics.overdue:0,color:"success",icon:(0,I.jsx)(l.ov,{icon:"ic:twotone-warning",sx:{width:64,height:64}})})}),(0,I.jsx)(s.cp,{item:!0,xs:12,children:(0,I.jsx)(A,{officeId:L(n,e),onRefresh:()=>u(),onView:e=>{v(e),g(!p)},onEdit:e=>{v(e),m(!0)}})})]}),!p&&(0,I.jsx)(i.Suspense,{children:(0,I.jsx)(V,{reportId:j,open:x,onClose:b})}),j&&(0,I.jsx)(i.Suspense,{children:(0,I.jsx)(z,{open:p,reportId:j,onClose:()=>{g(!1),v(null)}})}),(0,I.jsx)(l.wR,{severity:"error",message:(null===d||void 0===d?void 0:d.message)||(null===f||void 0===f?void 0:f.message)})]})}}}]);
//# sourceMappingURL=168.a57644fe.chunk.js.map