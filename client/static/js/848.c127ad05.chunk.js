"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[848],{3848:(e,t,n)=>{n.r(t),n.d(t,{default:()=>q});var i=n(9060),a=n(2656),s=n(6773),r=n(4488),l=n(7667),c=n(9572),o=n(9e3),d=n(5548),u=n(2112),p=n(3358),h=n(5448),m=n(8960),x=n(4380),v=n(3996),g=n(7868),j=n.n(g),f=n(9780),I=n(2892),b=n(7976),y=n(9720),D=n(9732),S=n(3540),E=n(4296),w=n(8964),C=n(2496);const R={reportId:"",subject:"",image:"",description:"",frequency:"NONE"};function q(e){let{eventId:t,selectedDate:n,open:g,onClose:q,role:N,officeId:O}=e;const{data:T,error:A}=(0,y.UL)(b.ei),{data:L,error:W}=(0,y.UL)(w.It,{fetchPolicy:"no-cache"}),[k,{error:B}]=(0,D.U)(b.wP,{fetchPolicy:"no-cache"}),[M,P]=(0,i.useState)(null),[Q,U]=(0,i.useState)(R),[Y,F]=(0,i.useState)([]),[J,G]=(0,i.useState)(j()(n)),[H,K]=(0,i.useState)(j()(n)),[V,z]=(0,i.useState)(j()(n)),{subject:X,description:Z,frequency:$,reportId:_}=Q,[ee,{error:te}]=(0,S.c)(b.Ki),[ne,{error:ie}]=(0,S.c)(b.cn),[ae,{error:se}]=(0,S.c)(b.cQ);(0,i.useEffect)((()=>{t?k({variables:{id:t}}).then((e=>{let{data:t}=e;t&&(U({subject:t.getEventById.subject,description:t.getEventById.description,frequency:t.getEventById.frequency,image:t.getEventById.image,reportId:""}),G(j()(new Date(t.getEventById.date))))})):(U(R),G(j()(new Date)))}),[t,k]),(0,i.useEffect)((()=>{G(j()(n)),K(j()(n)),z(j()(n))}),[n]);const re=e=>{U({...Q,[e.target.name]:e.target.value})};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(a.c,{open:g,onClose:q,maxWidth:"sm",fullWidth:!0,children:(0,C.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!N||!L||!O)return;let i=[];if(i=N===E.QJ.Director?Y.length>0?Y:L.getOffices.map((e=>parseInt(e.id))):[parseInt(O)],_)await ae({variables:{reportId:parseInt(_),localDue:H.toISOString(),nationalDue:V.toISOString()}});else{let e=null;if(M){const t=new FormData;t.append("files",M);const n=await f.c.post("https://rr6manila.com/api/upload",t);if(n.data){e=n.data.files[0].fileUrl}}t?await ne({variables:{id:t,subject:X,description:Z,image:e,date:J.toISOString(),frequency:$,scope:i}}):await ee({variables:{subject:X,description:Z,image:e,date:J.toISOString(),frequency:$,scope:i}})}U(R),G(j()(new Date(n))),K(j()(new Date(n))),z(j()(new Date(n))),q()},children:[t?(0,C.jsx)(s.c,{children:"Edit Event"}):(0,C.jsx)(u.c,{sx:{pt:2},children:"ADD EVENT"}),(0,C.jsxs)(r.c,{children:[(0,C.jsxs)(h.cp,{container:!0,spacing:3,children:[(0,C.jsx)(h.cp,{item:!0,xs:12,children:(0,C.jsx)(x.c,{name:"subject",label:"Event Name",variant:"outlined",value:X,onChange:re,fullWidth:!0,required:!_})}),(0,C.jsx)(h.cp,{item:!0,xs:12,children:(0,C.jsx)(x.c,{name:"description",label:"Description",variant:"outlined",value:Z,onChange:re,fullWidth:!0,required:!_,helperText:(null===M||void 0===M?void 0:M.name)||Q.image,InputProps:{endAdornment:(0,C.jsx)(c.c,{position:"end",children:(0,C.jsx)(p.c,{title:"Attach Image",children:(0,C.jsxs)(d.c,{component:"label",edge:"end",children:[(0,C.jsx)(I.ov,{icon:"tdesign:image-add"}),(0,C.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&P(e.target.files[0])},hidden:!0})]})})})}})}),(0,C.jsx)(h.cp,{item:!0,xs:12,sm:6,md:6,children:(0,C.jsx)(I.I4,{label:"Event Date",value:J,onChange:e=>{e&&G(e)}})}),(0,C.jsx)(h.cp,{item:!0,xs:12,sm:6,md:6,children:(0,C.jsxs)(x.c,{name:"frequency",select:!0,label:"Frequency",variant:"outlined",value:$,onChange:re,required:!_,fullWidth:!0,children:[(0,C.jsx)(v.c,{value:"NONE",children:"None"}),(0,C.jsx)(v.c,{value:"MONTHLY",children:"Monthly"}),(0,C.jsx)(v.c,{value:"QUARTERLY",children:"Quarterly"}),(0,C.jsx)(v.c,{value:"SEMESTRAL",children:"Semestral"}),(0,C.jsx)(v.c,{value:"YEARLY",children:"Yearly"})]})}),L&&N===E.QJ.Director&&(0,C.jsx)(h.cp,{item:!0,xs:12,children:(0,C.jsx)(I.e,{name:"scope",label:"Show To (Optional)",selected:Y,options:L.getOffices.map((e=>({id:parseInt(e.id),label:e.name}))),onChange:e=>{F(e)},required:!1})})]}),!t&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(u.c,{sx:{py:2},children:"OR ADD REPORT"}),(0,C.jsxs)(h.cp,{container:!0,spacing:3,children:[(0,C.jsx)(h.cp,{item:!0,xs:12,children:(0,C.jsx)(x.c,{name:"reportId",select:!0,label:"Report",variant:"outlined",value:_,onChange:re,required:!!_,fullWidth:!0,children:T&&T.getReports.map((e=>(0,C.jsx)(v.c,{value:e.id,children:e.name},e.id)))})}),(0,C.jsx)(h.cp,{item:!0,xs:12,sm:6,md:6,children:(0,C.jsx)(I.I4,{label:"Regional Deadline",value:H,onChange:e=>{e&&K(e)}})}),(0,C.jsx)(h.cp,{item:!0,xs:12,sm:6,md:6,children:(0,C.jsx)(I.I4,{label:"National Deadline",value:V,onChange:e=>{e&&z(e)}})})]})]})]}),(0,C.jsx)(l.c,{children:(0,C.jsxs)(m.c,{direction:"row",spacing:2,children:[(0,C.jsx)(o.c,{onClick:q,color:"inherit",children:"Cancel"}),(0,C.jsx)(o.c,{variant:"contained",color:"inherit",type:"submit",children:"Save"})]})})]})}),(0,C.jsx)(I.wR,{severity:"error",message:(null===te||void 0===te?void 0:te.message)||(null===B||void 0===B?void 0:B.message)||(null===ie||void 0===ie?void 0:ie.message)||(null===A||void 0===A?void 0:A.message)||(null===se||void 0===se?void 0:se.message)||(null===W||void 0===W?void 0:W.message)})]})}},6773:(e,t,n)=>{n.d(t,{c:()=>v});var i=n(5072),a=n(5656),s=n(9060),r=n(9736),l=n(7067),c=n(6880),o=n(2556),d=n(2128),u=n(2172),p=n(6432),h=n(2496);const m=["className","id"],x=(0,o.cp)(c.c,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),v=s.forwardRef((function(e,t){const n=(0,d.C)({props:e,name:"MuiDialogTitle"}),{className:c,id:o}=n,v=(0,a.c)(n,m),g=n,j=(e=>{const{classes:t}=e;return(0,l.c)({root:["root"]},u.G,t)})(g),{titleId:f=o}=s.useContext(p.c);return(0,h.jsx)(x,(0,i.c)({component:"h2",className:(0,r.c)(j.root,c),ownerState:g,ref:t,variant:"h6",id:null!=o?o:f},v))}))}}]);
//# sourceMappingURL=848.c127ad05.chunk.js.map