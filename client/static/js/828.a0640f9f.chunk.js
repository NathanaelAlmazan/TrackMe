"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[828],{447:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var r=n(9060),i=n(7256),l=n(272),a=n(3692),o=n(8960),s=n(9e3),c=n(8320),u=n(6880),d=n(5548),f=n(3996),v=n(1552),h=n(9572),m=n(3288),p=n(9872),g=n(4194),x=n(2148),y=n(5084),j=n(4480),b=n(3540),C=n(9732),I=n(8964),w=n(4296),A=n(2496);function D(){const e=(0,m.c)(),t=(0,g.KX)(),[n,D]=(0,r.useState)(!1),[N,O]=(0,r.useState)({firstName:"",lastName:"",positionId:"",officeId:"",username:"",password:""}),[R,k]=(0,r.useState)(""),[S,V]=(0,r.useState)(null),[F,P]=(0,r.useState)(!1),[M,W]=(0,r.useState)([]),[q,E]=(0,r.useState)(),{firstName:T,lastName:Q,positionId:U,officeId:z,username:J,password:B}=N,{data:K,error:Z}=(0,j.U)(I.mq),{data:G,error:L}=(0,j.U)(I.It),[$,{error:_}]=(0,b.c)(I.uQ),[H,{error:X}]=(0,C.U)(I.GM),[Y,{error:ee}]=(0,C.U)(I.Mz);(0,r.useEffect)((()=>{if(N.officeId&&null!==K&&void 0!==K&&K.getPositions&&null!==G&&void 0!==G&&G.getOffices){const e=G.getOffices.find((e=>e.id===N.officeId));e&&W(function(e,t){return e.includes("Regional Director")?t.filter((e=>e.role===w.QJ.Director)):e.includes("Division")?t.filter((e=>e.role===w.QJ.Chief&&e.label.includes("Chief")||e.role===w.QJ.Officer)):e.includes("Revenue District Office")?t.filter((e=>e.role===w.QJ.Chief&&e.label.includes("District Officer")||e.role===w.QJ.Officer)):t.filter((e=>e.role===w.QJ.Officer))}(e.name,K.getPositions.map((e=>({id:e.id,label:e.label,role:e.role})))))}}),[N.officeId,G,K]);const te=e=>{O({...N,[e.target.name]:e.target.value})};return(0,A.jsxs)(i.c,{sx:{...(0,x.mo)({color:(0,p.W4)(e.palette.background.default,.5),imgUrl:"/assets/background/overlay_5.jpg"}),height:1},children:[(0,A.jsx)(y.Ml,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),(0,A.jsx)(o.c,{alignItems:"center",justifyContent:"center",sx:{height:1},children:(0,A.jsxs)(a.c,{sx:{p:5,width:1,maxWidth:420},children:[(0,A.jsx)(u.c,{variant:"h4",children:F?"ACCOUNT VERIFICATION":"SIGN UP"}),F?(0,A.jsxs)("form",{onSubmit:e=>{e.preventDefault(),Y({variables:{code:R,contact:J}}).then((e=>{let{data:n}=e;n&&n.confirmAccountVerify?t.push("/login"):E("Invalid verification code.")})).catch((e=>{E(e.message)}))},children:[(0,A.jsxs)(u.c,{variant:"body2",sx:{my:2},children:["Verification code was sent to ".concat(J,"."),(0,A.jsx)(s.c,{onClick:e=>{S&&H({variables:{uuid:S,contact:J}}).then((e=>{let{data:t}=e;t&&t.requestAccountVerify&&(P(!0),E(void 0))})).catch((e=>{E(e.message)}))},variant:"text",children:"Resend?"})]}),(0,A.jsx)(o.c,{spacing:2,sx:{mb:2},children:(0,A.jsx)(v.o,{length:6,value:R,onComplete:e=>{Y({variables:{code:e,contact:J}}).then((e=>{let{data:n}=e;n&&n.confirmAccountVerify?t.push("/login"):E("Invalid verification code.")})).catch((e=>{E(e.message)}))},onChange:e=>k(e)})}),(0,A.jsx)(o.c,{direction:"row",alignItems:"center",justifyContent:"center",sx:{my:2},children:(q||(null===X||void 0===X?void 0:X.message)||(null===ee||void 0===ee?void 0:ee.message))&&(0,A.jsx)(u.c,{variant:"body2",align:"center",color:"error",children:q||(null===X||void 0===X?void 0:X.message)||(null===ee||void 0===ee?void 0:ee.message)})}),(0,A.jsx)(s.c,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:"Verify Account"})]}):(0,A.jsxs)("form",{onSubmit:async e=>{e.preventDefault();let t=null,n=null;if(J.includes("@")){if(!/^([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})$/.test(J))return void E("Invalid email address.");t=J}else{const e=J.indexOf("9");if(e<0)return void E("Invalid phone number.");const t=J.substring(e,J.length);if(10!==t.length||!/^\d+$/.test(J))return void E("Invalid phone number.");n=t}if(!t&&!n)return void E("Please provide valid email or phone number.");const r=await $({variables:{firstName:T.trim(),lastName:Q.trim(),positionId:parseInt(U),officeId:parseInt(z),email:t,phone:n,password:B}});if(r.data&&r.data.createOfficer){const e=r.data.createOfficer.uuid;V(e),H({variables:{uuid:e,contact:J}}).then((e=>{let{data:t}=e;t&&t.requestAccountVerify&&(P(!0),E(void 0))})).catch((e=>{E(e.message)}))}else E("Account already exists.")},children:[(0,A.jsxs)(u.c,{variant:"body2",sx:{my:2},children:["Already have an account?",(0,A.jsx)(l.c,{href:"/login",variant:"subtitle2",sx:{ml:.5,cursor:"pointer"},children:"Sign in"})]}),(0,A.jsxs)(o.c,{spacing:2,sx:{mb:2},children:[(0,A.jsx)(c.c,{name:"firstName",label:"First Name",value:T,onChange:te,required:!0,fullWidth:!0}),(0,A.jsx)(c.c,{name:"lastName",label:"Last Name",value:Q,onChange:te,required:!0,fullWidth:!0}),G&&(0,A.jsx)(c.c,{name:"officeId",select:!0,label:"Office",value:z,onChange:te,required:!0,fullWidth:!0,children:G.getOffices.map((e=>(0,A.jsx)(f.c,{value:e.id,children:e.name},e.id)))}),K&&(0,A.jsx)(c.c,{name:"positionId",select:!0,label:"Position",value:U,onChange:te,required:!0,fullWidth:!0,children:M.map((e=>(0,A.jsx)(f.c,{value:e.id,children:e.label},e.id)))}),(0,A.jsx)(c.c,{name:"username",label:"Email or Phone Number (+63)",value:J,onChange:te,fullWidth:!0}),(0,A.jsx)(c.c,{name:"password",label:"Password",type:n?"text":"password",value:B,onChange:te,required:!0,fullWidth:!0,InputProps:{endAdornment:(0,A.jsx)(h.c,{position:"end",children:(0,A.jsx)(d.c,{onClick:()=>D(!n),edge:"end",children:(0,A.jsx)(y.ov,{icon:n?"eva:eye-fill":"eva:eye-off-fill"})})})}})]}),(0,A.jsx)(o.c,{direction:"row",alignItems:"center",justifyContent:"center",sx:{my:2},children:(q||(null===Z||void 0===Z?void 0:Z.message)||(null===L||void 0===L?void 0:L.message)||(null===_||void 0===_?void 0:_.message))&&(0,A.jsx)(u.c,{variant:"body2",align:"center",color:"error",children:q||(null===Z||void 0===Z?void 0:Z.message)||(null===L||void 0===L?void 0:L.message)||(null===_||void 0===_?void 0:_.message)})}),(0,A.jsx)(s.c,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:"Sign up"})]})]})})]})}},1552:(e,t,n)=>{n.d(t,{o:()=>b});var r,i=n(6692),l=n(2496),a=n(9060),o=n(2556),s=n(8320),c=n(7256);const u={TextFieldStyled:(0,o.cp)(s.c)(r||(r=(0,i.c)(["\n  input {\n    text-align: center;\n  }\n"])))},d=e=>(0,l.jsx)(u.TextFieldStyled,{...e}),f="ArrowLeft",v="ArrowRight",h="Backspace",m="Home",p="End";function g(e){return e.join("")}function x(e,t){return[...e,t]}function y(e){const t=a.useRef((()=>{throw new Error("Cannot call an event handler while rendering.")}));return a.useInsertionEffect((()=>{t.current=e})),a.useCallback((function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return null===(e=t.current)||void 0===e?void 0:e.call(t,...r)}),[])}const j=()=>!0,b=a.forwardRef(((e,t)=>{const{value:n="",length:r=4,autoFocus:i=!1,onChange:o,TextFieldsProps:s,onComplete:u,validateChar:b=j,className:C,onBlur:I,...w}=e,A=a.useRef(n),D=y(u),N=y((e=>{const t=e.slice(0,r);return{isCompleted:t.length===r,finalValue:t}}));a.useEffect((()=>{const{isCompleted:e,finalValue:t}=N(A.current);e&&D(t)}),[r,D,N]);const O=function(e,t){return e<=0?[]:Array.from({length:e},t)}(r,((e,t)=>({character:n[t]||"",inputRef:a.createRef()}))),R=e=>O.findIndex((t=>{let{inputRef:n}=t;return n.current===e})),k=()=>O.map((e=>{let{character:t}=e;return t})),S=(e,t)=>{const n=function(e,t,n){return e.map(((e,r)=>t===r?n:e))}(k(),e,t);return g(n)},V=e=>{var t;null===(t=O[e])||void 0===t||null===(t=t.inputRef.current)||void 0===t||t.select()},F=e=>{e+1!==r&&(O[e+1].character?V(e+1):(e=>{var t;null===(t=O[e])||void 0===t||null===(t=t.inputRef.current)||void 0===t||t.focus()})(e+1))},P=(e,t)=>"function"!=typeof b||b(e,t),M=e=>{const t=R(e.target);if(0===t&&e.target.value.length>1){const{finalValue:t,isCompleted:n}=N(e.target.value);return null!==o&&void 0!==o&&o(t),n&&null!==u&&void 0!==u&&u(t),void V(t.length-1)}const n=e.target.value[0]||"";let r=n;r&&!P(r,t)&&(r="");const i=S(t,r);null===o||void 0===o||o(i);const{isCompleted:l,finalValue:a}=N(i);l&&null!==u&&void 0!==u&&u(a),""!==r?i.length-1<t?V(i.length):F(t):""===n&&i.length<=t&&V(t-1)},W=e=>{const t=e.clipboardData.getData("text/plain"),n=e.target,i=O.findIndex((e=>{let{character:t,inputRef:r}=e;return""===t||r.current===n})),l=function(e,t,n){return e.reduce(((e,t,r)=>{const{characters:i,restArrayMerged:l}=e;if(r<n)return{restArrayMerged:l,characters:x(i,t)};const[a,...o]=l;return{restArrayMerged:o,characters:x(i,a||"")}}),{restArrayMerged:t,characters:[]}).characters}(k(),function(e){return e.split("")}(t),i).map(((e,t)=>P(e,t)?e:"")),a=g(l);null===o||void 0===o||o(a);const{isCompleted:s,finalValue:c}=N(a);s?(null!==u&&void 0!==u&&u(c),V(r-1)):V(a.length)};return(0,l.jsx)(c.c,{display:"flex",gap:"20px",alignItems:"center",ref:t,className:"MuiOtpInput-Box ".concat(C||""),...w,children:O.map(((e,t)=>{let{character:r,inputRef:a}=e;const{onPaste:c,onFocus:u,onKeyDown:g,className:x,onBlur:y,...j}="function"==typeof s?s(t)||{}:s||{};return(0,l.jsx)(d,{autoFocus:!!i&&0===t,autoComplete:"one-time-code",value:r,inputRef:a,className:"MuiOtpInput-TextField MuiOtpInput-TextField-".concat(t+1," ").concat(x||""),onPaste:e=>{e.preventDefault(),W(e),null===c||void 0===c||c(e)},onFocus:e=>{e.preventDefault(),e.target.select(),null===u||void 0===u||u(e)},onChange:M,onKeyDown:e=>{(e=>{const t=e.target,n=t.selectionStart,r=t.selectionEnd,i=R(t),l=0===n&&0===r;if(t.value===e.key)e.preventDefault(),F(i);else if(h===e.key)if(t.value){if(l){e.preventDefault();const t=S(i,"");null!==o&&void 0!==o&&o(t),t.length<=i&&V(i-1)}}else e.preventDefault(),V(i-1);else f===e.key?(e.preventDefault(),V(i-1)):v===e.key?(e.preventDefault(),V(i+1)):m===e.key?(e.preventDefault(),V(0)):p===e.key&&(e.preventDefault(),V(O.length-1))})(e),null===g||void 0===g||g(e)},onBlur:e=>{null!==y&&void 0!==y&&y(e),(e=>{if(!O.some((t=>{let{inputRef:n}=t;return n.current===e.relatedTarget}))){const{isCompleted:e,finalValue:t}=N(n);null===I||void 0===I||I(t,e)}})(e)},...j},t)}))})}))}}]);
//# sourceMappingURL=828.a0640f9f.chunk.js.map