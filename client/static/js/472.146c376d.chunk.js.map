{"version":3,"file":"static/js/472.146c376d.chunk.js","mappings":"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","sources":["sections/auth/verify.tsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Card from '@mui/material/Card';\r\nimport Stack from '@mui/material/Stack';\r\nimport Button from '@mui/material/Button';\r\nimport TextField from '@mui/material/TextField';\r\nimport Divider from '@mui/material/Divider';\r\nimport Chip from '@mui/material/Chip';\r\nimport Typography from '@mui/material/Typography';\r\nimport { alpha, useTheme } from '@mui/material/styles';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\n\r\nimport { useAppSelector, useRouter } from '../../hooks';\r\n\r\nimport { bgGradient } from '../../theme/css';\r\n\r\nimport { Logo, Iconify } from '../../components';\r\n\r\nimport { useLazyQuery } from '@apollo/client';\r\nimport { CONFIRM_VERIFY_ACCOUNT, REQUEST_VERIFY_ACCOUNT } from '../../graphql/users';\r\nimport { Role } from '../../__generated__/graphql';\r\n\r\n// ----------------------------------------------------------------------\r\ninterface AccountVerify {\r\n    email: string;\r\n    phone: string;\r\n    code: string;\r\n}\r\n\r\nconst formDefaults = {\r\n    email: '',\r\n    phone: '',\r\n    code: ''\r\n}\r\n\r\nexport default function AccountVerifyView() {\r\n  const theme = useTheme();\r\n  const { uuid: signed, role } = useAppSelector((state) => state.auth);\r\n  const { uuid } = useParams();\r\n\r\n  const router = useRouter();\r\n\r\n  const [error, setError] = useState<string>();\r\n  const [confirm, setConfirm] = useState<boolean>(false);\r\n  const [formData, setFormData] = useState<AccountVerify>(formDefaults);\r\n\r\n  const { email, phone, code } = formData;\r\n\r\n  const [requestVerify, { error: requestError }] = useLazyQuery(REQUEST_VERIFY_ACCOUNT);\r\n  const [confirmVerify, { error: confirmError }] = useLazyQuery(CONFIRM_VERIFY_ACCOUNT);\r\n\r\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    setFormData({...formData, [event.target.name]: event.target.value });\r\n  };\r\n\r\n  const handleSubmitRequest = (event: React.FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n\r\n    if (!uuid) {\r\n      setError(\"Invalid URL. Please relaod.\");\r\n      return\r\n    }\r\n\r\n    if (!email && !phone) {\r\n      setError(\"Please type your email or phone number.\");\r\n      return\r\n    }\r\n\r\n    requestVerify({ variables: { uuid, email, phone } })\r\n     .then(({ data }) => {\r\n            if (data && data.requestAccountVerify) {\r\n                setConfirm(true);\r\n                setError(undefined);\r\n            }\r\n        })\r\n     .catch((error) => {\r\n        setError(error.message);\r\n    });\r\n  };\r\n\r\n  const handleSubmitPassword = (event: React.FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n\r\n    confirmVerify({ variables: { email, phone, code } })\r\n    .then(({ data }) => {\r\n           if (data && data.confirmAccountVerify) {\r\n               if (signed && role) {\r\n                if ([Role.Superuser, Role.Director].includes(role)) router.push('/dashboard');\r\n                else router.push('/documents');\r\n               } else {\r\n                 router.push('/login');\r\n               }\r\n           }\r\n       })\r\n    .catch((error) => {\r\n        setError(error.message);\r\n    });\r\n  }\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        ...bgGradient({\r\n          color: alpha(theme.palette.background.default, 0.5),\r\n          imgUrl: '/assets/background/overlay_5.jpg',\r\n        }),\r\n        height: 1,\r\n      }}\r\n    >\r\n      <Logo\r\n        sx={{\r\n          position: 'fixed',\r\n          top: { xs: 16, md: 24 },\r\n          left: { xs: 16, md: 24 },\r\n        }}\r\n      />\r\n\r\n      <Stack alignItems=\"center\" justifyContent=\"center\" sx={{ height: 1 }}>\r\n        <Card\r\n          sx={{\r\n            p: 5,\r\n            width: 1,\r\n            maxWidth: 420,\r\n          }}\r\n        >\r\n          <Typography variant=\"h4\">ACCOUNT VERIFICATION</Typography>\r\n\r\n            {!confirm ? (\r\n                <form onSubmit={handleSubmitRequest}>\r\n                    <Stack spacing={2} sx={{ my: 3 }}>\r\n                        <TextField \r\n                            name=\"email\" \r\n                            label=\"Email\" \r\n                            type='email'\r\n                            value={email} \r\n                            onChange={handleChange}\r\n                            fullWidth\r\n                        />\r\n\r\n                        <Divider>\r\n                            <Chip label=\"OR\" size=\"medium\" />\r\n                        </Divider>\r\n\r\n                        <TextField \r\n                            name=\"phone\" \r\n                            label=\"Phone\" \r\n                            value={phone} \r\n                            onChange={handleChange}\r\n                            inputProps={{ minLength: 10, maxLength: 10 }}\r\n                            InputProps={{\r\n                              startAdornment: <InputAdornment position=\"start\">+63</InputAdornment>,\r\n                            }}\r\n                            fullWidth\r\n                        />\r\n                    </Stack>\r\n\r\n                    <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"center\" sx={{ my: 2 }}>\r\n                        {(requestError?.message || error) && (\r\n                            <Typography variant=\"body2\" align='center' color=\"error\">\r\n                                {requestError?.message || error}\r\n                            </Typography>\r\n                        )}\r\n                    </Stack>\r\n\r\n                    <Button\r\n                        fullWidth\r\n                        endIcon={<Iconify icon=\"mdi:arrow-right\" />}\r\n                        size=\"large\"\r\n                        type=\"submit\"\r\n                        variant=\"contained\"\r\n                        color=\"inherit\"\r\n                    >\r\n                        Send Code\r\n                    </Button>\r\n                </form>\r\n            ): (\r\n                <form onSubmit={handleSubmitPassword}>\r\n                    <Stack spacing={2} sx={{ my: 3 }}>\r\n                        <TextField \r\n                            name=\"code\" \r\n                            label=\"Code\" \r\n                            value={code} \r\n                            onChange={handleChange}\r\n                            required\r\n                            fullWidth\r\n                        />\r\n                    </Stack>\r\n\r\n                    <Stack direction=\"row\" alignItems=\"center\" justifyContent=\"center\" sx={{ my: 2 }}>\r\n                        {(confirmError?.message || error) && (\r\n                            <Typography variant=\"body2\" align='center' color=\"error\">\r\n                                {confirmError?.message || error}\r\n                            </Typography>\r\n                        )}\r\n                    </Stack>\r\n\r\n                    <Button\r\n                        fullWidth\r\n                        size=\"large\"\r\n                        type=\"submit\"\r\n                        variant=\"contained\"\r\n                        color=\"inherit\"\r\n                    >\r\n                        Verify Account\r\n                    </Button>\r\n                </form>\r\n            )}\r\n        </Card>\r\n      </Stack>\r\n    </Box>\r\n  );\r\n}"],"names":["formDefaults","email","phone","code","AccountVerifyView","theme","useTheme","uuid","signed","role","useAppSelector","state","auth","useParams","router","useRouter","error","setError","useState","confirm","setConfirm","formData","setFormData","requestVerify","requestError","useLazyQuery","REQUEST_VERIFY_ACCOUNT","confirmVerify","confirmError","CONFIRM_VERIFY_ACCOUNT","handleChange","event","target","name","value","_jsxs","Box","sx","bgGradient","color","alpha","palette","background","default","imgUrl","height","children","_jsx","Logo","position","top","xs","md","left","Stack","alignItems","justifyContent","Card","p","width","maxWidth","Typography","variant","onSubmit","preventDefault","variables","then","_ref2","data","confirmAccountVerify","Role","Superuser","Director","includes","push","catch","message","spacing","my","TextField","label","onChange","required","fullWidth","direction","align","Button","size","type","_ref","requestAccountVerify","undefined","Divider","Chip","inputProps","minLength","maxLength","InputProps","startAdornment","InputAdornment","endIcon","Iconify","icon"],"sourceRoot":""}