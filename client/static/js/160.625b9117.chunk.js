"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[160],{8160:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var r=n(9060),a=n(9448),i=n(272),o=n(3692),s=n(9072),l=n(7348),c=n(4380),u=n(6880),d=n(5548),f=n(1552),h=n(3288),p=n(4100),g=n(9572),v=n(4448),m=n(4194),x=n(2148),y=n(1424),j=n(9732),b=n(8964),C=n(4296),w=n(2496);function D(){const e=(0,h.c)(),t=(0,m.KX)(),n=(0,m.Ab)(),[D,A]=(0,r.useState)(!1),[I,O]=(0,r.useState)({username:"",password:""}),{username:k,password:S}=I,[R,N]=(0,r.useState)(""),[V,M]=(0,r.useState)(null),[F,T]=(0,r.useState)(!1),[E,P]=(0,r.useState)(),[W,{error:q}]=(0,j.U)(b.qy),[B,{error:J}]=(0,j.U)(b.GM),[Q,{error:U}]=(0,j.U)(b.Mz),$=e=>{O({...I,[e.target.name]:e.target.value})};return(0,w.jsxs)(a.c,{sx:{...(0,x.mo)({color:(0,p.W4)(e.palette.background.default,.5),imgUrl:"/assets/background/overlay_5.jpg"}),height:1},children:[(0,w.jsx)(y.Ml,{sx:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),(0,w.jsx)(s.c,{alignItems:"center",justifyContent:"center",sx:{height:1},children:(0,w.jsxs)(o.c,{sx:{p:5,width:1,maxWidth:420},children:[(0,w.jsx)(u.c,{variant:"h4",children:F?"ACCOUNT VERIFICATION":"SIGN IN"}),F?(0,w.jsxs)("form",{onSubmit:e=>{e.preventDefault(),Q({variables:{code:R,contact:k}}).then((e=>{let{data:r}=e;if(V&&r&&r.confirmAccountVerify){var a;const e=null===(a=r.confirmAccountVerify.position)||void 0===a?void 0:a.role;n((0,v.Mp)(V)),e?[C.QJ.Superuser,C.QJ.Director].includes(e)?t.push("/dashboard"):t.push("/calendar"):t.push("/login")}})).catch((e=>{P(e.message)}))},children:[(0,w.jsxs)(u.c,{variant:"body2",sx:{my:2},children:[`Verification code was sent to ${k}.`,(0,w.jsx)(l.c,{onClick:e=>{null!==V&&void 0!==V&&V.uuid&&B({variables:{uuid:V.uuid,contact:k}}).then((e=>{let{data:t}=e;t&&t.requestAccountVerify&&(T(!0),P(void 0))})).catch((e=>{P(e.message)}))},variant:"text",children:"Resend?"})]}),(0,w.jsx)(s.c,{spacing:2,sx:{mb:2},children:(0,w.jsx)(f.o,{length:6,value:R,onChange:e=>N(e)})}),(0,w.jsx)(s.c,{direction:"row",alignItems:"center",justifyContent:"center",sx:{my:2},children:(E||(null===J||void 0===J?void 0:J.message)||(null===U||void 0===U?void 0:U.message))&&(0,w.jsx)(u.c,{variant:"body2",align:"center",color:"error",children:E||(null===J||void 0===J?void 0:J.message)||(null===U||void 0===U?void 0:U.message)})}),(0,w.jsx)(l.c,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:"Verify Account"})]}):(0,w.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=await W({variables:{username:k,password:S}});if(r.data&&r.data.loginOfficer){var a,i,o;const e={uuid:r.data.loginOfficer.uuid,firstName:r.data.loginOfficer.firstName,lastName:r.data.loginOfficer.lastName,role:null===(a=r.data.loginOfficer.position)||void 0===a?void 0:a.role,office:null===(i=r.data.loginOfficer.office)||void 0===i?void 0:i.id,position:null===(o=r.data.loginOfficer.position)||void 0===o?void 0:o.label,avatar:r.data.loginOfficer.avatar};if(M(e),r.data.loginOfficer.verified){var s;n((0,v.Mp)(e));const a=(null===(s=r.data.loginOfficer.position)||void 0===s?void 0:s.role)||C.QJ.Officer;[C.QJ.Superuser,C.QJ.Director].includes(a)?t.push("/dashboard"):t.push("/calendar")}else B({variables:{uuid:r.data.loginOfficer.uuid,contact:k}}).then((e=>{let{data:t}=e;t&&t.requestAccountVerify&&(T(!0),P(void 0))})).catch((e=>{P(e.message)}))}else P("Wrong credentials or account is inactive.")},children:[(0,w.jsxs)(u.c,{variant:"body2",sx:{my:2},children:["Don't have an account?",(0,w.jsx)(i.c,{href:"/register",variant:"subtitle2",sx:{ml:.5,cursor:"pointer"},children:"Sign up"})]}),(0,w.jsxs)(s.c,{spacing:2,sx:{mb:2},children:[(0,w.jsx)(c.c,{name:"username",label:"Email or Phone Number (+63)",value:k,onChange:$,required:!0,fullWidth:!0}),(0,w.jsx)(c.c,{name:"password",label:"Password",type:D?"text":"password",value:S,onChange:$,required:!0,fullWidth:!0,inputProps:{minLength:8},InputProps:{endAdornment:(0,w.jsx)(g.c,{position:"end",children:(0,w.jsx)(d.c,{onClick:()=>A(!D),edge:"end",children:(0,w.jsx)(y.ov,{icon:D?"eva:eye-fill":"eva:eye-off-fill"})})})}})]}),(0,w.jsx)(s.c,{direction:"row",alignItems:"center",justifyContent:"flex-end",children:(0,w.jsx)(i.c,{href:"/password",variant:"subtitle2",underline:"hover",children:"Forgot password?"})}),(0,w.jsx)(s.c,{direction:"row",alignItems:"center",justifyContent:"center",sx:{my:2},children:((null===q||void 0===q?void 0:q.message)||E)&&(0,w.jsx)(u.c,{variant:"body2",align:"center",color:"error",children:(null===q||void 0===q?void 0:q.message)||E})}),(0,w.jsx)(l.c,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",children:"Sign in"})]})]})})]})}},1552:(e,t,n)=>{n.d(t,{o:()=>y});var r=n(2496),a=n(9060),i=n(2556),o=n(4380),s=n(9448);const l={TextFieldStyled:(0,i.cp)(o.c)`
  input {
    text-align: center;
  }
`},c=e=>(0,r.jsx)(l.TextFieldStyled,{...e}),u="ArrowLeft",d="ArrowRight",f="Backspace",h="Home",p="End";function g(e){return e.join("")}function v(e,t){return[...e,t]}function m(e){const t=a.useRef((()=>{throw new Error("Cannot call an event handler while rendering.")}));return a.useInsertionEffect((()=>{t.current=e})),a.useCallback((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.current?.(...n)}),[])}const x=()=>!0,y=a.forwardRef(((e,t)=>{const{value:n="",length:i=4,autoFocus:o=!1,onChange:l,TextFieldsProps:y,onComplete:j,validateChar:b=x,className:C,onBlur:w,...D}=e,A=a.useRef(n),I=m(j),O=m((e=>{const t=e.slice(0,i);return{isCompleted:t.length===i,finalValue:t}}));a.useEffect((()=>{const{isCompleted:e,finalValue:t}=O(A.current);e&&I(t)}),[i,I,O]);const k=function(e,t){return e<=0?[]:Array.from({length:e},t)}(i,((e,t)=>({character:n[t]||"",inputRef:a.createRef()}))),S=e=>k.findIndex((t=>{let{inputRef:n}=t;return n.current===e})),R=()=>k.map((e=>{let{character:t}=e;return t})),N=(e,t)=>{const n=function(e,t,n){return e.map(((e,r)=>t===r?n:e))}(R(),e,t);return g(n)},V=e=>{k[e]?.inputRef.current?.select()},M=e=>{e+1!==i&&(k[e+1].character?V(e+1):(e=>{k[e]?.inputRef.current?.focus()})(e+1))},F=(e,t)=>"function"!=typeof b||b(e,t),T=e=>{const t=S(e.target);if(0===t&&e.target.value.length>1){const{finalValue:t,isCompleted:n}=O(e.target.value);return l?.(t),n&&j?.(t),void V(t.length-1)}const n=e.target.value[0]||"";let r=n;r&&!F(r,t)&&(r="");const a=N(t,r);l?.(a);const{isCompleted:i,finalValue:o}=O(a);i&&j?.(o),""!==r?a.length-1<t?V(a.length):M(t):""===n&&a.length<=t&&V(t-1)},E=e=>{const t=e.clipboardData.getData("text/plain"),n=e.target,r=k.findIndex((e=>{let{character:t,inputRef:r}=e;return""===t||r.current===n})),a=function(e,t,n){return e.reduce(((e,t,r)=>{const{characters:a,restArrayMerged:i}=e;if(r<n)return{restArrayMerged:i,characters:v(a,t)};const[o,...s]=i;return{restArrayMerged:s,characters:v(a,o||"")}}),{restArrayMerged:t,characters:[]}).characters}(R(),function(e){return e.split("")}(t),r).map(((e,t)=>F(e,t)?e:"")),o=g(a);l?.(o);const{isCompleted:s,finalValue:c}=O(o);s?(j?.(c),V(i-1)):V(o.length)};return(0,r.jsx)(s.c,{display:"flex",gap:"20px",alignItems:"center",ref:t,className:`MuiOtpInput-Box ${C||""}`,...D,children:k.map(((e,t)=>{let{character:a,inputRef:i}=e;const{onPaste:s,onFocus:g,onKeyDown:v,className:m,onBlur:x,...j}="function"==typeof y?y(t)||{}:y||{};return(0,r.jsx)(c,{autoFocus:!!o&&0===t,autoComplete:"one-time-code",value:a,inputRef:i,className:`MuiOtpInput-TextField MuiOtpInput-TextField-${t+1} ${m||""}`,onPaste:e=>{e.preventDefault(),E(e),s?.(e)},onFocus:e=>{e.preventDefault(),e.target.select(),g?.(e)},onChange:T,onKeyDown:e=>{(e=>{const t=e.target,n=t.selectionStart,r=t.selectionEnd,a=S(t),i=0===n&&0===r;if(t.value===e.key)e.preventDefault(),M(a);else if(f===e.key)if(t.value){if(i){e.preventDefault();const t=N(a,"");l?.(t),t.length<=a&&V(a-1)}}else e.preventDefault(),V(a-1);else u===e.key?(e.preventDefault(),V(a-1)):d===e.key?(e.preventDefault(),V(a+1)):h===e.key?(e.preventDefault(),V(0)):p===e.key&&(e.preventDefault(),V(k.length-1))})(e),v?.(e)},onBlur:e=>{x?.(e),(e=>{if(!k.some((t=>{let{inputRef:n}=t;return n.current===e.relatedTarget}))){const{isCompleted:e,finalValue:t}=O(n);w?.(t,e)}})(e)},...j},t)}))})}))}}]);
//# sourceMappingURL=160.625b9117.chunk.js.map